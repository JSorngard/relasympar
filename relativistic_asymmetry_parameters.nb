(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    170202,       4284]
NotebookOptionsPosition[    163371,       4176]
NotebookOutlinePosition[    163806,       4193]
CellTagsIndexPosition[    163763,       4190]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Theory", "Section",
 CellChangeTimes->{{3.8569329752940645`*^9, 
  3.8569329793243527`*^9}},ExpressionUUID->"619a4e76-f68e-40da-a0f6-\
f3c8486f3cc3"],

Cell[TextData[{
 "When an electron is ionized by absorbing two linearly polarized photons the \
radial photoelectron wavefunction will asymptotically be described by an \
outgoing phase-shifted Coulomb wave which at large distances from the ion \
will approach a plane wave. Relativistically the wave function of an electron \
has four components, that can be grouped as two components with two spin \
states. In nonrelativistic scenarios the second component approaches zero, \
and in most scenarios the first component tends to be larger. They are \
therefore colloquially known as the large and small components. For the \
outgoing photoelectron these components look like\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubsuperscriptBox["u", 
      RowBox[{"q", ",", "\[Omega]", ",", "\[CapitalOmega]", ",", "b"}], 
      RowBox[{"(", 
       RowBox[{"f", ",", "2"}], ")"}]], "(", "r", ")"}], "\[RightArrow]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{
       SuperscriptBox["\[Pi]M", 
        RowBox[{"(", "2", ")"}]], "(", 
       RowBox[{"q", ",", "\[Omega]", ",", "\[CapitalOmega]", ",", "b"}], 
       ")"}]}], 
     SqrtBox[
      FractionBox["1", 
       RowBox[{"1", "+", 
        SuperscriptBox["\[Zeta]", "2"]}]]], 
     SqrtBox[
      RowBox[{
       FractionBox[
        RowBox[{"2", "m"}], 
        SuperscriptBox["\[Pi]k\[HBar]", "2"]], 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         FractionBox["\[Epsilon]", 
          SuperscriptBox["mc", "2"]]}], ")"}]}]], 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", "(", 
       RowBox[{"kr", "+", 
        RowBox[{"\[Eta]ln", "(", 
         RowBox[{"2", "kr"}], ")"}], "-", 
        RowBox[{
         SubscriptBox["l", "f"], 
         FractionBox["\[Pi]", "2"], 
         SubscriptBox["\[Sigma]", 
          RowBox[{"Z", ",", "k", ",", 
           SubscriptBox["l", "f"]}]]}], "+", 
        SubscriptBox["\[Delta]", 
         RowBox[{"Z", ",", "k", ",", "\[Kappa]", ",", 
          SubscriptBox["l", "f"]}]]}], ")"}]]}]}], TraditionalForm]],
  ExpressionUUID->"321d7547-f6c6-41b1-9221-76bee0ca52e2"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubsuperscriptBox["u", 
      RowBox[{"q", ",", "\[Omega]", ",", "\[CapitalOmega]", ",", "b"}], 
      RowBox[{"(", 
       RowBox[{"g", ",", "2"}], ")"}]], "(", "r", ")"}], "\[RightArrow]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{
       SuperscriptBox["\[ImaginaryI]\[Pi]M", 
        RowBox[{"(", "2", ")"}]], "(", 
       RowBox[{"q", ",", "\[Omega]", ",", "\[CapitalOmega]", ",", "b"}], 
       ")"}]}], "\[Zeta]", 
     SqrtBox[
      FractionBox["1", 
       RowBox[{"1", "+", 
        SuperscriptBox["\[Zeta]", "2"]}]]], 
     SqrtBox[
      RowBox[{
       FractionBox[
        RowBox[{"2", "m"}], 
        SuperscriptBox["\[Pi]k\[HBar]", "2"]], 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         FractionBox["\[Epsilon]", 
          SuperscriptBox["mc", "2"]]}], ")"}]}]], 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", "(", 
       RowBox[{"kr", "+", 
        RowBox[{"\[Eta]ln", "(", 
         RowBox[{"2", "kr"}], ")"}], "-", 
        RowBox[{
         SubscriptBox["l", "f"], 
         FractionBox["\[Pi]", "2"], 
         SubscriptBox["\[Sigma]", 
          RowBox[{"Z", ",", "k", ",", 
           SubscriptBox["l", "f"]}]]}], "+", 
        SubscriptBox["\[Delta]", 
         RowBox[{"Z", ",", "k", ",", "\[Kappa]", ",", 
          SubscriptBox["l", "f"]}]]}], ")"}]]}]}], TraditionalForm]],
  ExpressionUUID->"4904907b-c290-4fc4-9be2-a71d31cda5ec"],
 "\nwhere ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Zeta]", "=", 
    SqrtBox[
     FractionBox[
      RowBox[{"E", "-", 
       SuperscriptBox["mc", "2"]}], 
      RowBox[{"E", "+", 
       SuperscriptBox["mc", "2"]}]]]}], TraditionalForm]],ExpressionUUID->
  "8806c612-f95d-4185-92df-679fcc423628"],
 "=",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox["k\[HBar]", 
     RowBox[{"2", "mc"}]], 
    FractionBox["1", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       FractionBox["\[Epsilon]", 
        RowBox[{"2", 
         SuperscriptBox["mc", "2"]}]]}], ")"}]]}], TraditionalForm]],
  ExpressionUUID->"c168120f-c2b3-473b-9de9-f6e066baf3b8"],
 "."
}], "Text",
 CellChangeTimes->{{3.856932982099255*^9, 3.856933305768622*^9}, {
  3.85693338202918*^9, 3.8569336368154325`*^9}, {3.8569337187003407`*^9, 
  3.856933776427963*^9}},ExpressionUUID->"00ccf6c8-cf0c-4137-b148-\
fef25c451da8"],

Cell[TextData[{
 "The full wavefunction is\n\[CapitalPsi](r,\[Theta],\[Phi])=",
 Cell[BoxData[
  FormBox[
   TemplateBox[{
     RowBox[{
       RowBox[{
         SubsuperscriptBox["u", 
          RowBox[{"q", ",", "\[Omega]", ",", "\[CapitalOmega]", ",", "b"}], 
          RowBox[{"(", 
            RowBox[{"f", ",", "2"}], ")"}]], "(", "r", ")"}], 
       RowBox[{
         SubscriptBox["\[Chi]", "\[Kappa]m"], "(", 
         RowBox[{"\[Theta]", ",", "\[Phi]", ",", "\[Sigma]"}], ")"}]}], 
     RowBox[{
       RowBox[{
         SubsuperscriptBox["u", 
          RowBox[{"q", ",", "\[Omega]", ",", "\[CapitalOmega]", ",", "b"}], 
          RowBox[{"(", 
            RowBox[{"g", ",", "2"}], ")"}]], "(", "r", ")"}], 
       RowBox[{
         SubscriptBox["\[Chi]", 
          RowBox[{"-", "\[Kappa]m"}]], "(", 
         RowBox[{"\[Theta]", ",", "\[Phi]", ",", "\[Sigma]"}], ")"}]}]},
    "Binomial"], TraditionalForm]],
  CellChangeTimes->{3.8569338206064925`*^9},ExpressionUUID->
  "e1ec7caf-825b-48b2-b286-a13b08d5cab8"],
 "\nwhere\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[Chi]", "\[Kappa]m"], "(", 
     RowBox[{"\[Theta]", ",", "\[Phi]", ",", "\[Sigma]"}], ")"}], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Sum]", 
       RowBox[{
        SubscriptBox["m", "l"], 
        SubscriptBox["m", "s"]}]], 
      RowBox[{
       RowBox[{"\[LeftAngleBracket]", 
        RowBox[{
         SubscriptBox["lm", "l"], ",", 
         RowBox[{
          SubscriptBox["sm", "s"], "|", 
          SubscriptBox["jm", "j"]}]}], "\[RightAngleBracket]"}], 
       RowBox[{
        SubscriptBox["Y", 
         RowBox[{"l", ",", 
          SubscriptBox["m", "l"]}]], "(", 
        RowBox[{"\[Theta]", ",", "\[Phi]"}], ")"}], 
       RowBox[{"\[Xi]", "(", "\[Sigma]", ")"}]}]}], "=", 
     RowBox[{
      SubscriptBox["\[Sum]", 
       RowBox[{
        SubscriptBox["m", "l"], 
        SubscriptBox["m", "s"]}]], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], 
        RowBox[{"l", "-", "s", "+", 
         SubscriptBox["m", "j"]}]], 
       SqrtBox[
        RowBox[{
         RowBox[{"2", "j"}], "+", "1"}]], 
       RowBox[{
        TagBox[
         StyleBox["(",
          SpanMaxSize->DirectedInfinity[1]],
         ThreeJSymbol], "\[MediumSpace]", GridBox[{
          {"l", "s", "j"},
          {
           SubscriptBox["m", "l"], 
           SubscriptBox["m", "s"], 
           RowBox[{"-", 
            SubscriptBox["m", "j"]}]}
         }], "\[MediumSpace]", 
        TagBox[
         StyleBox[")",
          SpanMaxSize->DirectedInfinity[1]],
         ThreeJSymbol]}], 
       RowBox[{
        SubscriptBox["Y", 
         RowBox[{"l", ",", 
          SubscriptBox["m", "l"]}]], "(", 
        RowBox[{"\[Theta]", ",", "\[Phi]"}], ")"}], 
       RowBox[{
        SubscriptBox["\[Xi]", 
         SubscriptBox["m", "s"]], "(", "\[Sigma]", ")"}]}]}]}]}], 
   TraditionalForm]],ExpressionUUID->"a67f46a1-0583-4c46-bb86-5f0b73fc5c08"],
 "\nand \[Kappa]=l(l+1)-j(j+1)-1/4."
}], "Text",
 CellChangeTimes->{{3.856933786024108*^9, 3.856933998405961*^9}, {
  3.8569340391745*^9, 
  3.856934119303682*^9}},ExpressionUUID->"74620cda-7603-47ed-a416-\
9b8b15e1c3d1"],

Cell[TextData[{
 "If we assume that the photon operators are coupled together, and that we \
thus do not need to care about the angular momentum quantum numbers of the \
intermediate state. The wave function is then\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"-", "\[Pi]"}], 
    SqrtBox[
     FractionBox["1", 
      RowBox[{"1", "+", 
       SuperscriptBox["\[Zeta]", "2"]}]]], 
    SqrtBox[
     RowBox[{
      FractionBox[
       RowBox[{"2", "m"}], 
       SuperscriptBox["\[Pi]k\[HBar]", "2"]], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        FractionBox["\[Epsilon]", 
         SuperscriptBox["mc", "2"]]}], ")"}]}]], 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", "(", 
      RowBox[{"kr", "+", 
       RowBox[{"\[Eta]ln", "(", 
        RowBox[{"2", "kr"}], ")"}]}], ")"}]], 
    RowBox[{"A", "(", 
     RowBox[{"\[Theta]", ",", "\[Phi]"}], ")"}]}], TraditionalForm]],
  ExpressionUUID->"3995b7e8-dc19-4943-8eb6-93dc2570c548"],
 "\nwhere\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"A", 
     RowBox[{"(", 
      RowBox[{"\[Theta]", ",", "\[Phi]"}], ")"}]}], "=", 
    RowBox[{
     SubscriptBox["\[Sum]", 
      SubscriptBox["\[Kappa]m", "j"]], 
     RowBox[{
      SubscriptBox["\[Sum]", "K"], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], 
        RowBox[{"j", "+", "K", "+", 
         SubscriptBox["j", "0"]}]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], 
        RowBox[{"j", "-", 
         SubscriptBox["m", "j"]}]], 
       RowBox[{
        TagBox[
         StyleBox["(",
          SpanMaxSize->DirectedInfinity[1]],
         ThreeJSymbol], "\[MediumSpace]", GridBox[{
          {"j", "K", 
           SubscriptBox["j", "0"]},
          {
           RowBox[{"-", 
            SubscriptBox["m", "j"]}], "0", 
           SubscriptBox["m", "j"]}
         }], "\[MediumSpace]", 
        TagBox[
         StyleBox[")",
          SpanMaxSize->DirectedInfinity[1]],
         ThreeJSymbol]}], 
       TemplateBox[{
         RowBox[{
           SubscriptBox["\[Sum]", 
            RowBox[{
              SubscriptBox["m", 
               SubscriptBox["l", "f"]], 
              SubscriptBox["m", "s"]}]], 
           RowBox[{
             RowBox[{"\[LeftAngleBracket]", 
               RowBox[{
                 RowBox[{
                   SubscriptBox["l", "f"], 
                   SubscriptBox["m", 
                    SubscriptBox["l", "f"]]}], ",", 
                 RowBox[{
                   SubscriptBox["sm", "s"], "|", 
                   SubscriptBox["jm", "j"]}]}], "\[RightAngleBracket]"}], 
             RowBox[{
               SubscriptBox["Y", 
                RowBox[{
                  SubscriptBox["l", "f"], ",", 
                  SubscriptBox["m", 
                   SubscriptBox["l", "f"]]}]], "(", 
               RowBox[{"\[Theta]", ",", "\[Phi]"}], ")"}], 
             SubscriptBox["\[Xi]", 
              SubscriptBox["m", "s"]]}]}], 
         RowBox[{"\[ImaginaryI]\[Zeta]", 
           RowBox[{
             SubscriptBox["\[Sum]", 
              RowBox[{
                SubscriptBox["m", 
                 SubscriptBox["l", "g"]], 
                SubscriptBox["m", "s"]}]], 
             RowBox[{
               RowBox[{"\[LeftAngleBracket]", 
                 RowBox[{
                   RowBox[{
                    SubscriptBox["l", "g"], 
                    SubscriptBox["m", 
                    SubscriptBox["l", "g"]]}], ",", 
                   RowBox[{
                    SubscriptBox["sm", "s"], "|", 
                    SubscriptBox["jm", "j"]}]}], "\[RightAngleBracket]"}], 
               RowBox[{
                 SubscriptBox["Y", 
                  RowBox[{
                    SubscriptBox["l", "g"], ",", 
                    SubscriptBox["m", 
                    SubscriptBox["l", "g"]]}]], "(", 
                 RowBox[{"\[Theta]", ",", "\[Phi]"}], ")"}], 
               SubscriptBox["\[Xi]", 
                SubscriptBox["m", "s"]]}]}]}]},
        "Binomial"], 
       SubscriptBox["M", 
        RowBox[{"\[Kappa]", ",", "K"}]]}]}]}]}], TraditionalForm]],
  ExpressionUUID->"f04252e0-4187-42ed-bb10-128f7fa8f9da"],
 "\nThe final angular momenta of the large and small components are computed \
using ",
 Cell[BoxData[
  FormBox[
   RowBox[{"j", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["l", "f"], "+", 
       SubscriptBox["m", "s"]}], "\[Implies]", 
      SubscriptBox["l", "f"]}], "=", 
     RowBox[{"j", "\[MinusPlus]", 
      RowBox[{"1", "/", "2"}]}]}]}], TraditionalForm]],ExpressionUUID->
  "5a418f0f-f172-4a90-af41-e92fa16673cc"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["l", "g"], "=", 
    RowBox[{
     SubscriptBox["l", "f"], "\[PlusMinus]", "1"}]}], TraditionalForm]],
  ExpressionUUID->"99d02dfc-06ad-4e60-935a-731f3bec6700"],
 ". The ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["M", "\[Kappa]"], TraditionalForm]],ExpressionUUID->
  "9a52f9b8-5e6b-40b0-a942-cef3f73aa705"],
 " matrix elements can be computed separately as\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["M", 
     RowBox[{"\[Kappa]", ",", "K"}]], "=", 
    RowBox[{
     SubscriptBox["\[Sum]", 
      RowBox[{
       RowBox[{"\[Gamma]", "''"}], ",", 
       RowBox[{"j", "''"}]}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", "K"}], "+", "1"}], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"a3b114fd-ca1c-4147-9140-0818e1fc9e61"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{"j", "'"}], "||", 
      SuperscriptBox["C", "1"], "||", 
      RowBox[{"j", "''"}]}], "\[RightAngleBracket]"}], 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{"j", "''"}], "||", 
      SuperscriptBox["C", "1"], "||", "j"}], "\[RightAngleBracket]"}], 
    RowBox[{
     TagBox[
      StyleBox["{",
       SpanMaxSize->DirectedInfinity[1]],
      SixJSymbol], "\[MediumSpace]", GridBox[{
       {"1", "1", "K"},
       {"j", 
        SuperscriptBox["j", "\[Prime]",
         MultilineFunction->None], 
        SuperscriptBox["j", "\[Prime]\[Prime]",
         MultilineFunction->None]}
      }], "\[MediumSpace]", 
     TagBox[
      StyleBox["}",
       SpanMaxSize->DirectedInfinity[1]],
      SixJSymbol]}], 
    RowBox[{
     TagBox[
      StyleBox["(",
       SpanMaxSize->DirectedInfinity[1]],
      ThreeJSymbol], "\[MediumSpace]", GridBox[{
       {"1", "1", "K"},
       {"0", "0", "0"}
      }], "\[MediumSpace]", 
     TagBox[
      StyleBox[")",
       SpanMaxSize->DirectedInfinity[1]],
      ThreeJSymbol]}], 
    SubscriptBox["R", 
     RowBox[{"\[Gamma]j", "\[RightArrow]", 
      RowBox[{
       RowBox[{"\[Gamma]", "''"}], 
       RowBox[{"j", "''"}]}], "\[RightArrow]", 
      RowBox[{
       RowBox[{"\[Gamma]", "'"}], 
       RowBox[{"j", "'"}]}]}]], 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", "(", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SubscriptBox["l", "f"]}], 
         FractionBox["\[Pi]", "2"]}], "+", 
        SubscriptBox["\[Sigma]", 
         RowBox[{"Z", ",", "k", ",", 
          SubscriptBox["l", "f"]}]], "+", "\[Delta]_Z"}], ",", "k", ",", 
       "\[Kappa]", ",", 
       SubscriptBox["l", "f"]}], ")"}]]}], TraditionalForm]],ExpressionUUID->
  "8380b8fb-fbbf-44a9-ba9a-566543b3e97b"],
 ",\nwhere ",
 Cell[BoxData[
  FormBox["R", TraditionalForm]],ExpressionUUID->
  "75921eaa-d08e-4c9e-ba72-c75442644cd5"],
 " is the radial part of the matrix element."
}], "Text",
 CellChangeTimes->{{3.856934120438157*^9, 3.856934147042302*^9}, {
  3.856934190764569*^9, 3.8569347424946218`*^9}, {3.856934778711809*^9, 
  3.8569349253547564`*^9}, {3.856934986518089*^9, 3.856934987955119*^9}, {
  3.856939788797767*^9, 3.8569398117320995`*^9}, {3.869895948454908*^9, 
  3.8698959655826993`*^9}},ExpressionUUID->"2973d668-cee1-4625-8528-\
230b3fcc7229"],

Cell[TextData[{
 "Asymmetry parameters are a way of parametrizing 3D-distributions. A \
distribution can be expanded as ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"f", "(", 
     RowBox[{"\[Theta]", ",", "\[Phi]"}], ")"}], "=", 
    RowBox[{
     FractionBox[
      SubscriptBox["\[Sigma]", "0"], 
      RowBox[{"4", "\[Pi]"}]], 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{
        SubscriptBox["\[Sum]", 
         RowBox[{"l", ",", "m"}]], 
        RowBox[{
         SqrtBox[
          FractionBox[
           RowBox[{"4", "\[Pi]"}], 
           RowBox[{
            RowBox[{"2", "l"}], "+", "1"}]]], 
         SubscriptBox["\[Beta]", 
          RowBox[{"l", ",", "m"}]], 
         RowBox[{
          SubscriptBox["Y", 
           RowBox[{"l", ",", "m"}]], "(", 
          RowBox[{"\[Theta]", ",", "\[Phi]"}], ")"}]}]}]}], ")"}]}]}], 
   TraditionalForm]],ExpressionUUID->"4be65adb-e348-4568-9a2c-ae9cc733f016"],
 ", where ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Beta]", 
    RowBox[{"l", ",", "m"}]], TraditionalForm]],ExpressionUUID->
  "ad8966e1-9e29-4bd5-9757-3f27d5ea9231"],
 " are the asymmetry parameters. The factor of ",
 Cell[BoxData[
  FormBox[
   SqrtBox[
    FractionBox[
     RowBox[{"4", "\[Pi]"}], 
     RowBox[{
      RowBox[{"2", "l"}], "+", "1"}]]], TraditionalForm]],ExpressionUUID->
  "0b3c2d5c-a09d-4e5e-9c63-318e3eaa88c8"],
 " makes sure that this definition matches a more common definition that \
doesn\[CloseCurlyQuote]t parametrize over \[Phi] when m=0. With a little bit \
of algebra it can be seen that these parameters can be computed as\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Beta]", 
     RowBox[{"l", ",", "m"}]], "=", 
    RowBox[{
     FractionBox[
      SqrtBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "l"}], "+", "1"}], ")"}], "4", "\[Pi]"}]], 
      SubscriptBox["\[Sigma]", "0"]], 
     SubscriptBox["B", 
      RowBox[{"l", ",", "m"}]]}]}], TraditionalForm]],ExpressionUUID->
  "4421b37c-132d-41eb-87c3-011b5ab69f2c"],
 ",\nwhere\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Sigma]", "0"], "=", 
    RowBox[{
     SqrtBox[
      RowBox[{"4", "\[Pi]"}]], 
     SubscriptBox["B", 
      RowBox[{"0", ",", "0"}]]}]}], TraditionalForm]],ExpressionUUID->
  "41e00286-4373-4bae-88b5-296ec7f741b6"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["B", 
     RowBox[{"l", ",", "m"}]], "=", 
    RowBox[{
     RowBox[{"\[Integral]", 
      RowBox[{
       SubsuperscriptBox["Y", 
        RowBox[{"l", ",", "m"}], "*"], "(", 
       RowBox[{"\[Theta]", ",", "\[Phi]"}], ")"}]}], "|", 
     RowBox[{"f", "(", 
      RowBox[{"\[Theta]", ",", "\[Phi]"}], ")"}], 
     SuperscriptBox["|", "2"], 
     RowBox[{"\[DifferentialD]", "\[CapitalOmega]"}]}]}], TraditionalForm]],
  ExpressionUUID->"e1f98bcc-39a1-4a2f-8247-79c07a644411"],
 "."
}], "Text",
 CellChangeTimes->{{3.85693502439671*^9, 3.856935396865707*^9}, {
  3.856935513863363*^9, 3.85693557323346*^9}, {3.856935671660524*^9, 
  3.856935733582252*^9}, {3.856935820027531*^9, 3.856935909362664*^9}, {
  3.904033479472721*^9, 3.904033569319607*^9}, {3.9040337127475452`*^9, 
  3.904033789593523*^9}, {3.904033925590794*^9, 3.904033928426289*^9}, {
  3.9040339790691175`*^9, 
  3.904033993553045*^9}},ExpressionUUID->"36b43be4-4739-4ff4-a46b-\
db5c0409f318"],

Cell[TextData[{
 "If we want to apply this to the relativistic photoelectron wavefunction we \
need to evaluate ",
 Cell[BoxData[
  FormBox[
   RowBox[{"|", 
    RowBox[{"A", 
     RowBox[{"(", 
      RowBox[{"\[Theta]", ",", "\[Phi]"}], ")"}]}], 
    SuperscriptBox["|", "2"]}], TraditionalForm]],ExpressionUUID->
  "536ec3df-0a85-4546-9640-a7b457e0fc12"],
 ". In the case of a typical photoelectron measurement we do not detect the \
ion, and thus there is an implicit integration over the angles of the ion, \
leading to any cross term between the different ionic m-values cancelling \
out. A more detailed discussion can be found this article: \
https://doi.org/10.1088/1361-6455/ab84c6\nThis means that the expression for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"|", "A", 
    SuperscriptBox["|", "2"]}], TraditionalForm]],ExpressionUUID->
  "3bf3a202-0fce-41be-9ece-ee1bffab2c49"],
 " will have the ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["m", "j"], TraditionalForm]],ExpressionUUID->
  "98b874f0-d977-4823-b9e2-d0e807ecee0d"],
 "s summed over outside the absolute value squared. Using that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Integral]", 
     RowBox[{
      SubscriptBox["Y", 
       RowBox[{"l1", ",", "m1"}]], 
      SubscriptBox["Y", 
       RowBox[{"l2", ",", "m2"}]], 
      SubscriptBox["Y", 
       RowBox[{"l3", ",", "m3"}]], 
      RowBox[{"\[DifferentialD]", "\[CapitalOmega]"}]}]}], "=", 
    RowBox[{
     SqrtBox[
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "l1"}], "+", "1"}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "l2"}], "+", "1"}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "l3"}], "+", "1"}], ")"}]}], 
       RowBox[{"4", "\[Pi]"}]]], 
     RowBox[{
      TagBox[
       StyleBox["(",
        SpanMaxSize->DirectedInfinity[1]],
       ThreeJSymbol], "\[MediumSpace]", GridBox[{
        {"l1", "l2", "l3"},
        {"0", "0", "0"}
       }], "\[MediumSpace]", 
      TagBox[
       StyleBox[")",
        SpanMaxSize->DirectedInfinity[1]],
       ThreeJSymbol]}], 
     RowBox[{
      TagBox[
       StyleBox["(",
        SpanMaxSize->DirectedInfinity[1]],
       ThreeJSymbol], "\[MediumSpace]", GridBox[{
        {"l1", "l2", "l3"},
        {"m1", "m2", "m3"}
       }], "\[MediumSpace]", 
      TagBox[
       StyleBox[")",
        SpanMaxSize->DirectedInfinity[1]],
       ThreeJSymbol]}]}]}], TraditionalForm]],ExpressionUUID->
  "e235f83d-b418-4723-a89e-251567d49588"],
 "  and that the spin functions ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    SubscriptBox["\[Xi]", 
     SubscriptBox["m", "s"]]}], TraditionalForm]],ExpressionUUID->
  "78720826-25c8-4f99-927c-f2ea5c9eca2a"],
 ") are orthonormal, the expression for the asymmetry parameters (assuming \
linearly polarized light) can be evaluated to be\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Beta]", 
     RowBox[{"l", ",", "0"}]], " ", "=", 
    RowBox[{
     SqrtBox[
      FractionBox[
       RowBox[{
        RowBox[{"2", "l"}], "+", "1"}], 
       RowBox[{"4", "\[Pi]"}]]], 
     FractionBox["1", 
      SubscriptBox["\[Beta]", 
       RowBox[{"0", ",", "0"}]]], 
     RowBox[{
      SubscriptBox["\[Sum]", 
       SubscriptBox["m", "j"]], 
      RowBox[{
       SubscriptBox["\[Sum]", 
        RowBox[{"KK", "'"}]], 
       RowBox[{
        SubscriptBox["\[Sum]", 
         RowBox[{"\[Kappa]\[Kappa]", "'"}]], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], 
          RowBox[{
           RowBox[{"2", " ", "j"}], "+", 
           RowBox[{"2", "j0"}], "+", 
           RowBox[{"2", " ", "jp"}], "+", "k", "+", "kp", "-", 
           RowBox[{"2", " ", "mj"}]}]], 
         RowBox[{
          TagBox[
           StyleBox["(",
            SpanMaxSize->DirectedInfinity[1]],
           ThreeJSymbol], "\[MediumSpace]", GridBox[{
            {"j", "K", 
             SubscriptBox["j", "0"]},
            {
             RowBox[{"-", 
              SubscriptBox["m", "j"]}], "0", 
             SubscriptBox["m", "j"]}
           }], "\[MediumSpace]", 
          TagBox[
           StyleBox[")",
            SpanMaxSize->DirectedInfinity[1]],
           ThreeJSymbol]}], 
         RowBox[{
          TagBox[
           StyleBox["(",
            SpanMaxSize->DirectedInfinity[1]],
           ThreeJSymbol], "\[MediumSpace]", GridBox[{
            {
             RowBox[{"j", "'"}], 
             RowBox[{"K", "'"}], 
             SubscriptBox["j", "0"]},
            {
             RowBox[{"-", 
              SubscriptBox["m", "j"]}], "0", 
             SubscriptBox["m", "j"]}
           }], "\[MediumSpace]", 
          TagBox[
           StyleBox[")",
            SpanMaxSize->DirectedInfinity[1]],
           ThreeJSymbol]}], 
         RowBox[{
          SubscriptBox["\[Sum]", 
           SubscriptBox["m", "s"]], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SubscriptBox["\[Sum]", 
               RowBox[{
                SubscriptBox["m", 
                 SubscriptBox["l", "f"]], 
                SubscriptBox["m", 
                 SubscriptBox[
                  RowBox[{"l", "'"}], "f"]]}]], 
              RowBox[{
               RowBox[{"\[LeftAngleBracket]", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["l", "f"], 
                  SubscriptBox["m", 
                   SubscriptBox["l", "f"]]}], ",", 
                 RowBox[{
                  RowBox[{
                   FractionBox["1", "2"], 
                   SubscriptBox["m", "s"]}], "|", 
                  SubscriptBox["jm", "j"]}]}], "\[RightAngleBracket]"}], 
               RowBox[{"\[LeftAngleBracket]", 
                RowBox[{
                 RowBox[{
                  SubscriptBox[
                   RowBox[{"l", "'"}], "f"], 
                  SubscriptBox["m", 
                   SubscriptBox[
                    RowBox[{"l", "'"}], "f"]]}], ",", 
                 RowBox[{
                  RowBox[{
                   FractionBox["1", "2"], 
                   SubscriptBox["m", "s"]}], "|", 
                  SubscriptBox["jm", "j"]}]}], "\[RightAngleBracket]"}], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], 
                SubscriptBox["m", 
                 SubscriptBox[
                  RowBox[{"l", "'"}], "f"]]], 
               SqrtBox[
                FractionBox[
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"2", 
                    SubscriptBox["l", "f"]}], "+", "1"}], ")"}], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"2", 
                    SubscriptBox[
                    RowBox[{"l", "'"}], "f"]}], "+", "1"}], ")"}], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"2", "l"}], "+", "1"}], ")"}]}], 
                 RowBox[{"4", "\[Pi]"}]]], 
               RowBox[{
                TagBox[
                 StyleBox["(",
                  SpanMaxSize->DirectedInfinity[1]],
                 ThreeJSymbol], "\[MediumSpace]", GridBox[{
                  {
                   SubscriptBox["l", "f"], 
                   SubscriptBox[
                    RowBox[{"l", "'"}], "f"], "l"},
                  {"0", "0", "0"}
                 }], "\[MediumSpace]", 
                TagBox[
                 StyleBox[")",
                  SpanMaxSize->DirectedInfinity[1]],
                 ThreeJSymbol]}], 
               RowBox[{
                TagBox[
                 StyleBox["(",
                  SpanMaxSize->DirectedInfinity[1]],
                 ThreeJSymbol], "\[MediumSpace]", GridBox[{
                  {
                   SubscriptBox["l", "f"], 
                   SubscriptBox[
                    RowBox[{"l", "'"}], "f"], "l"},
                  {
                   SubscriptBox["m", 
                    SubscriptBox["l", "f"]], 
                   RowBox[{"-", 
                    SubscriptBox["m", 
                    SubscriptBox[
                    RowBox[{"l", "'"}], "f"]]}], "0"}
                 }], "\[MediumSpace]", 
                TagBox[
                 StyleBox[")",
                  SpanMaxSize->DirectedInfinity[1]],
                 ThreeJSymbol]}]}]}], "+", 
             RowBox[{
              SuperscriptBox["\[Zeta]", "2"], 
              RowBox[{
               SubscriptBox["\[Sum]", 
                RowBox[{
                 SubscriptBox["m", 
                  SubscriptBox["l", "g"]], 
                 SubscriptBox["m", 
                  SubscriptBox[
                   RowBox[{"l", "'"}], "g"]]}]], 
               RowBox[{
                RowBox[{"\[LeftAngleBracket]", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["l", "g"], 
                   SubscriptBox["m", 
                    SubscriptBox["l", "g"]]}], ",", 
                  RowBox[{
                   RowBox[{
                    FractionBox["1", "2"], 
                    SubscriptBox["m", "s"]}], "|", 
                   SubscriptBox["jm", "j"]}]}], "\[RightAngleBracket]"}], 
                RowBox[{"\[LeftAngleBracket]", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox[
                    RowBox[{"l", "'"}], "g"], 
                   SubscriptBox["m", 
                    SubscriptBox[
                    RowBox[{"l", "'"}], "g"]]}], ",", 
                  RowBox[{
                   RowBox[{
                    FractionBox["1", "2"], 
                    SubscriptBox["m", "s"]}], "|", 
                   SubscriptBox["jm", "j"]}]}], "\[RightAngleBracket]"}], 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"-", "1"}], ")"}], 
                 SubscriptBox["m", 
                  SubscriptBox[
                   RowBox[{"l", "'"}], "g"]]], 
                SqrtBox[
                 FractionBox[
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", 
                    SubscriptBox["l", "g"]}], "+", "1"}], ")"}], 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", 
                    SubscriptBox[
                    RowBox[{"l", "'"}], "g"]}], "+", "1"}], ")"}], 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "l"}], "+", "1"}], ")"}]}], 
                  RowBox[{"4", "\[Pi]"}]]], 
                RowBox[{
                 TagBox[
                  StyleBox["(",
                   SpanMaxSize->DirectedInfinity[1]],
                  ThreeJSymbol], "\[MediumSpace]", GridBox[{
                   {
                    SubscriptBox["l", "g"], 
                    SubscriptBox[
                    RowBox[{"l", "'"}], "g"], "l"},
                   {"0", "0", "0"}
                  }], "\[MediumSpace]", 
                 TagBox[
                  StyleBox[")",
                   SpanMaxSize->DirectedInfinity[1]],
                  ThreeJSymbol]}], 
                RowBox[{
                 TagBox[
                  StyleBox["(",
                   SpanMaxSize->DirectedInfinity[1]],
                  ThreeJSymbol], "\[MediumSpace]", GridBox[{
                   {
                    SubscriptBox["l", "g"], 
                    SubscriptBox[
                    RowBox[{"l", "'"}], "g"], "l"},
                   {
                    SubscriptBox["m", 
                    SubscriptBox["l", "g"]], 
                    RowBox[{"-", 
                    SubscriptBox["m", 
                    SubscriptBox[
                    RowBox[{"l", "'"}], "g"]]}], "0"}
                  }], "\[MediumSpace]", 
                 TagBox[
                  StyleBox[")",
                   SpanMaxSize->DirectedInfinity[1]],
                  ThreeJSymbol]}]}]}]}]}], ")"}], 
           SubscriptBox["M", 
            RowBox[{"\[Kappa]", ",", "K"}]], 
           SubsuperscriptBox["M", 
            RowBox[{
             RowBox[{"\[Kappa]", "'"}], ",", 
             RowBox[{"K", "'"}]}], "*"]}]}]}]}]}]}]}]}], TraditionalForm]],
  ExpressionUUID->"43f2e1cd-58fb-4aae-9728-ee7ea5f48189"],
 "\nThe sum over K and K\[CloseCurlyQuote] goes over 0 and 2 (K=1 doesn\
\[CloseCurlyQuote]t contribute for linearly polarized light due to the 3j and \
6j-symbols in the definition of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["M", 
    RowBox[{"\[Kappa]", ",", "K"}]], TraditionalForm]],ExpressionUUID->
  "5c3090cc-c93d-4634-ab4b-f5e3ec0a5aa2"],
 "), the sum over ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["m", "j"], TraditionalForm]],ExpressionUUID->
  "f1037ba9-0fd0-4299-b2c8-129b3d7ff8a6"],
 " goes from ",
 Cell[BoxData[
  FormBox[
   RowBox[{"-", 
    SubscriptBox["j", "0"]}], TraditionalForm]],ExpressionUUID->
  "81a3a83f-6cd3-4d19-a6ee-aed05e3a9620"],
 " to ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["j", "0"], TraditionalForm]],ExpressionUUID->
  "2d00d3cc-67ec-406a-ae98-debbee336d4d"],
 ", and the sum over \[Kappa] and \[Kappa]\[CloseCurlyQuote] goes over the \
possible final states.\nIt is this expression that is implemented in the \
function RelativisitcAsymmetryParameter[]."
}], "Text",
 CellChangeTimes->{{3.8569359121880193`*^9, 3.856935950625667*^9}, {
  3.856935986660469*^9, 3.856936039946683*^9}, {3.856936185330571*^9, 
  3.8569362034778957`*^9}, {3.856936355714118*^9, 3.8569365270427904`*^9}, {
  3.856936573911237*^9, 3.8569366803866663`*^9}, {3.85693853961518*^9, 
  3.856938571662562*^9}, {3.856938603760297*^9, 3.856939103874684*^9}, {
  3.8569391601037636`*^9, 3.8569393068530703`*^9}, {3.856939393066597*^9, 
  3.8569394059929285`*^9}, {3.856939442525995*^9, 3.856939581704916*^9}, {
  3.856939744609655*^9, 3.856939783666265*^9}, {3.864192358847022*^9, 
  3.864192362076609*^9}, {3.869896006747367*^9, 
  3.8698960068771744`*^9}},ExpressionUUID->"5ea61c3f-ecbc-43fc-916b-\
7b734d6fdbb0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Auxiliary functions", "Section",
 CellChangeTimes->{{3.855912977427569*^9, 3.8559129831771836`*^9}, {
  3.856935639041794*^9, 
  3.8569356447410383`*^9}},ExpressionUUID->"57efb09f-efdb-4f37-b484-\
ad434e3bde34"],

Cell["\<\
These functions are used by the other functions. Run this cell to define them.\
\>", "Text",
 CellChangeTimes->{{3.8566013034848084`*^9, 
  3.856601331670069*^9}},ExpressionUUID->"2be18b71-54e8-484e-afa5-\
fd17148a3168"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Translates", " ", 
    RowBox[{"\[Xi]", "[", 
     RowBox[{
      RowBox[{"\[PlusMinus]", "1"}], "/", "2"}], "]"}], " ", "into", " ", 
    SubscriptBox["\[Xi]", "\[PlusMinus]"]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Xi]", "[", "ms_", "]"}], "/;", 
     RowBox[{
      RowBox[{"ms", "\[Equal]", 
       RowBox[{"1", "/", "2"}]}], "||", 
      RowBox[{"ms", "\[Equal]", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]}]}]}], ":=", 
    SubscriptBox["\[Xi]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ms", "\[Equal]", 
        RowBox[{"1", "/", "2"}]}], ",", "\"\<+\>\"", ",", "\"\<-\>\""}], 
      "]"}]]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Computes", " ", "l", " ", "and", " ", "j", " ", "from", " ", 
     "\[Kappa]"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"lj", "[", "\[Kappa]_Integer", "]"}], "/;", 
     RowBox[{"\[Kappa]", "\[NotEqual]", "0"}]}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Sign", "[", "\[Kappa]", "]"}], "\[Equal]", 
         RowBox[{"-", "1"}]}], ",", 
        RowBox[{
         RowBox[{"-", "\[Kappa]"}], "-", "1"}], ",", "\[Kappa]"}], "]"}], ",", 
      FractionBox[
       RowBox[{
        RowBox[{"2", 
         RowBox[{"Abs", "[", "\[Kappa]", "]"}]}], "-", "1"}], "2"]}], "}"}]}],
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Computes", " ", "j", " ", "from", " ", "\[Kappa]"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"j", "[", "\[Kappa]_Integer", "]"}], "/;", 
     RowBox[{"\[Kappa]", "\[NotEqual]", "0"}]}], ":=", 
    FractionBox[
     RowBox[{
      RowBox[{"2", 
       RowBox[{"Abs", "[", "\[Kappa]", "]"}]}], "-", "1"}], "2"]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Computes", " ", "the", " ", "possible", " ", "final", " ", "\[Kappa]", 
     " ", "in", " ", "a", " ", "one", " ", "or", " ", "two", " ", "photon", 
     " ", "tansition", " ", "starting", " ", "from", " ", "\[Kappa]0"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Kappa]f", "[", 
      RowBox[{"\[Kappa]0_", ",", 
       RowBox[{"photons_", ":", "2"}]}], "]"}], "/;", 
     RowBox[{
      RowBox[{"photons", "\[Equal]", "1"}], "||", 
      RowBox[{"photons", "\[Equal]", "2"}]}]}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"sig", ",", "mag"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sig", "=", 
        RowBox[{"Sign", "[", "\[Kappa]0", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"mag", "=", 
        RowBox[{"Abs", "[", "\[Kappa]0", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"photons", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Kappa]0", "\[Equal]", 
             RowBox[{"-", "1"}]}], "||", 
            RowBox[{"\[Kappa]0", "\[Equal]", "1"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"sig", " ", "mag"}], ",", 
             RowBox[{
              RowBox[{"-", "sig"}], 
              RowBox[{"(", 
               RowBox[{"mag", "+", "1"}], ")"}]}], ",", 
             RowBox[{"sig", 
              RowBox[{"(", 
               RowBox[{"mag", "+", "2"}], ")"}]}]}], "}"}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Kappa]0", "\[Equal]", 
               RowBox[{"-", "2"}]}], "||", 
              RowBox[{"\[Kappa]0", "\[Equal]", "2"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "sig"}], 
                RowBox[{"(", 
                 RowBox[{"mag", "-", "1"}], ")"}]}], ",", "\[Kappa]0", ",", 
               RowBox[{
                RowBox[{"-", "sig"}], 
                RowBox[{"(", 
                 RowBox[{"mag", "+", "1"}], ")"}]}], ",", 
               RowBox[{"sig", 
                RowBox[{"(", 
                 RowBox[{"mag", "+", "2"}], ")"}]}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"sig", 
                RowBox[{"(", 
                 RowBox[{"mag", "-", "2"}], ")"}]}], ",", 
               RowBox[{
                RowBox[{"-", "sig"}], 
                RowBox[{"(", 
                 RowBox[{"mag", "-", "1"}], ")"}]}], ",", "\[Kappa]0", ",", 
               RowBox[{
                RowBox[{"-", "sig"}], 
                RowBox[{"(", 
                 RowBox[{"mag", "+", "1"}], ")"}]}], ",", 
               RowBox[{"sig", 
                RowBox[{"(", 
                 RowBox[{"mag", "+", "2"}], ")"}]}]}], "}"}]}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ",",
          "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"mag", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "sig"}], " ", "mag"}], ",", 
             RowBox[{"sig", 
              RowBox[{"(", 
               RowBox[{"mag", "+", "1"}], ")"}]}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"sig", 
              RowBox[{"(", 
               RowBox[{"mag", "-", "1"}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"-", "sig"}], " ", "mag"}], ",", 
             RowBox[{"sig", 
              RowBox[{"(", 
               RowBox[{"mag", "+", "1"}], ")"}]}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Computes", " ", "the", " ", "integral", " ", "of", " ", "three", " ", 
     "spherical", " ", "harmonics", " ", "in", " ", "spherical", " ", 
     "coordinates"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Gaunt", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"l1_", ",", "m1_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"l2_", ",", "m2_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"l3_", ",", "m3_"}], "}"}]}], "]"}], ":=", 
    RowBox[{
     SqrtBox[
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "l1"}], "+", "1"}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "l2"}], "+", "1"}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "l3"}], "+", "1"}], ")"}]}], 
       RowBox[{"4", "\[Pi]"}]]], 
     RowBox[{"ThreeJSymbol", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"l1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l2", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l3", ",", "0"}], "}"}]}], "]"}], 
     RowBox[{"ThreeJSymbol", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"l1", ",", "m1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l2", ",", "m2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l3", ",", "m3"}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DistributeConjugates", "[", "expr_", "]"}], ":=", 
    RowBox[{"FixedPoint", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"#", "/.", 
          RowBox[{
           RowBox[{"Conjugate", "[", "a_", "]"}], "\[RuleDelayed]", 
           RowBox[{"Conjugate", "[", 
            RowBox[{"Expand", "[", "a", "]"}], "]"}]}]}], ")"}], "/.", 
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{"a_", "+", "b_"}], "]"}], "\[RuleDelayed]", 
         RowBox[{
          RowBox[{"Conjugate", "[", "a", "]"}], "+", 
          RowBox[{"Conjugate", "[", "b", "]"}]}]}]}], "&"}], ",", "expr"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.855911595207579*^9, 3.855911638035637*^9}, {
   3.855912911310867*^9, 3.855913044942752*^9}, 3.855980627282482*^9, {
   3.856500101750968*^9, 3.856500137655409*^9}, {3.856515635561143*^9, 
   3.8565156872837086`*^9}, {3.856516219066614*^9, 3.856516222055997*^9}, {
   3.856584905442012*^9, 3.8565849057962003`*^9}, {3.8565850474750957`*^9, 
   3.856585048477974*^9}, {3.856597997600849*^9, 3.856598019396722*^9}, {
   3.856600563579436*^9, 3.85660060193717*^9}, 3.856846630369485*^9, {
   3.856846668110008*^9, 3.856846707772338*^9}, {3.8569355982989283`*^9, 
   3.856935604709354*^9}, 3.8569396185240383`*^9, {3.8574589777880163`*^9, 
   3.8574589780359135`*^9}, {3.8589182229140987`*^9, 3.858918223321753*^9}, {
   3.8599672966621494`*^9, 3.8599673561355357`*^9}, {3.859967415103148*^9, 
   3.859967415673403*^9}, {3.8602140227318788`*^9, 3.860214058834689*^9}, {
   3.8602141033138037`*^9, 3.8602143133525825`*^9}, {3.860214547893495*^9, 
   3.860214548211054*^9}},
 CellLabel->"In[93]:=",ExpressionUUID->"1b51d95f-1b9f-463e-8dc8-c446fb139799"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Asymmetry Parameter Function", "Section",
 CellChangeTimes->{{3.8565979757292724`*^9, 
  3.856597984875581*^9}},ExpressionUUID->"96d938b5-2331-42bc-82a9-\
918d3fc193a9"],

Cell["\<\
This function computes the asymmetry parameters for a single path \
relativistic two-photon process\
\>", "Text",
 CellChangeTimes->{{3.856598135508384*^9, 
  3.856598155206357*^9}},ExpressionUUID->"c5314769-e6c9-420a-8992-\
de4486e2b1a7"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "RelativisticAsymmetryParameter", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "RelativisticAsymmetryParameter", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Normalize", "\[Rule]", "True"}], ",", 
     RowBox[{"SinglePhoton", "\[Rule]", "False"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RelativisticAsymmetryParameter", "::", "badoptval"}], "=", 
   "\"\<`1` is not a valid value for option `2`\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RelativisticAsymmetryParameter", "::", "usage"}], "=", 
   "\"\<Returns the asymmetry parameter for a single path relativistic one- \
or two-photon process. The first input is the index of the wanted asymmetry \
parameter and the second input is the \[Kappa] quantum number of the initial \
state (can not be 0). Both must be integers. Normalization can be turned off \
with the option Normalize->False, and the number of photons can be set to 1 \
(instead of 2) with SinglePhoton->True.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RelativisticAsymmetryParameter", "[", 
     RowBox[{"n_Integer", ",", "\[Kappa]0_Integer", ",", 
      RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], "/;", 
    RowBox[{
     RowBox[{"n", "\[GreaterEqual]", "0"}], "&&", 
     RowBox[{"\[Kappa]0", "\[NotEqual]", "0"}]}]}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "final\[Kappa]s", ",", "lf", ",", "lfp", ",", "j", ",", "jp", ",", "lg",
        ",", "lgp", ",", "l0", ",", "j0", ",", "label", ",", "normalize", ",",
        "error", ",", "photons", ",", "mag", ",", "sig", ",", "singlePhoton", 
       ",", "ks"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Read", " ", "in", " ", "and", " ", "validate", " ", "option", " ", 
       "values"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"normalize", "=", 
       RowBox[{"OptionValue", "[", "Normalize", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"error", "=", "False"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"BooleanQ", "[", "normalize", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"RelativisticAsymmetryParameter", "::", "badoptval"}], ",",
            "normalize", ",", "Normalize"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"error", "=", "True"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"singlePhoton", "=", 
       RowBox[{"OptionValue", "[", "SinglePhoton", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"BooleanQ", "[", "singlePhoton", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"RelativisticAsymmetryParameter", "::", "badoptval"}], ",",
            "singlePhoton", ",", "SinglePhoton"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"error", "=", "True"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"photons", "=", 
       RowBox[{"If", "[", 
        RowBox[{"singlePhoton", ",", "1", ",", "2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "If", " ", "there", " ", "was", " ", "no", " ", "error", " ", "when", 
        " ", "reading", " ", "in", " ", "the", " ", "options", " ", "we", " ",
         "continue"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", "error"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"l0", ",", "j0"}], "}"}], "=", 
          RowBox[{"lj", "[", "\[Kappa]0", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"mag", "=", 
          RowBox[{"Abs", "[", "\[Kappa]0", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"sig", "=", 
          RowBox[{"Sign", "[", "\[Kappa]0", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"final\[Kappa]s", "=", 
          RowBox[{"\[Kappa]f", "[", 
           RowBox[{"\[Kappa]0", ",", "photons"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ks", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"photons", "\[Equal]", "2"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "2"}], "}"}], 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{
              "For", " ", "linearly", " ", "polarized", " ", "light"}], ",", 
              " ", 
              RowBox[{"K", "=", 
               RowBox[{"1", " ", 
                RowBox[{"doesn", "'"}], "t", " ", "contribute"}]}]}], "*)"}], 
            ",", 
            RowBox[{"{", "1", "}"}]}], 
           RowBox[{"(*", 
            RowBox[{
            "A", " ", "one", " ", "photon", " ", "operator", " ", "has", " ", 
             "a", " ", "rank", " ", "of", " ", "1"}], "*)"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Simplify", "[", 
          RowBox[{
           SqrtBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", "n"}], "+", "1"}], ")"}], "4", "\[Pi]"}]], 
           RowBox[{"(*", 
            RowBox[{
            "Normalize", " ", "the", " ", "result", " ", "if", " ", 
             "requested"}], "*)"}], 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"n", ">", "0"}], "&&", "normalize"}], ",", 
             FractionBox["1", 
              RowBox[{"RelativisticAsymmetryParameter", "[", 
               RowBox[{"0", ",", "\[Kappa]0", ",", 
                RowBox[{"SinglePhoton", "\[Rule]", "singlePhoton"}]}], "]"}]],
              ",", "1"}], "]"}], 
           RowBox[{"(*", 
            RowBox[{"Sum", " ", "incoherently", " ", "over", " ", "the", " ", 
             SubscriptBox["m", "j"], " ", "quantum", " ", "number", " ", 
             "and", " ", "coherently", " ", "over", " ", "the", " ", "K", " ",
              "and", " ", "\[Kappa]", " ", "values", " ", "of", " ", "the", 
             " ", "final", " ", "state"}], "*)"}], 
           RowBox[{"Quiet", "@", 
            RowBox[{"Sum", "[", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "Compute", " ", "the", " ", "l", " ", "and", " ", "j", " ", 
               "values", " ", "of", " ", "the", " ", "upper", " ", "and", " ",
                "lower", " ", "components", " ", "in", " ", "the", " ", 
               "final", " ", 
               RowBox[{"state", ".", " ", "Each"}], " ", "of", " ", "these", 
               " ", "come", " ", "in", " ", "two", " ", "copies", " ", "of", 
               " ", "themselves", " ", "to", " ", "enable", " ", "coherent", 
               " ", 
               RowBox[{"summation", "."}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"lf", ",", "j"}], "}"}], "=", 
                RowBox[{"lj", "[", "\[Kappa]", "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"lfp", ",", "jp"}], "}"}], "=", 
                RowBox[{"lj", "[", "\[Kappa]p", "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"lg", "=", 
                RowBox[{"lf", "-", 
                 RowBox[{"Sign", "[", "\[Kappa]", "]"}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"lgp", "=", 
                RowBox[{"lfp", "-", 
                 RowBox[{"Sign", "[", "\[Kappa]p", "]"}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"-", "1"}], ")"}], 
                 RowBox[{"j", "-", "mj"}]], 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"-", "1"}], ")"}], 
                 RowBox[{"jp", "-", "mj"}]], 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"photons", "\[Equal]", "2"}], ",", 
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], 
                    RowBox[{"j", "+", "k", "+", "j0"}]], 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], 
                    RowBox[{"jp", "+", "kp", "+", "j0"}]]}], ",", "1"}], 
                 "]"}], 
                RowBox[{"ThreeJSymbol", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"j", ",", 
                    RowBox[{"-", "mj"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"k", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"j0", ",", "mj"}], "}"}]}], "]"}], 
                RowBox[{"ThreeJSymbol", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"jp", ",", 
                    RowBox[{"-", "mj"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"kp", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"j0", ",", "mj"}], "}"}]}], "]"}], 
                RowBox[{"(", 
                 RowBox[{"Sum", "[", 
                  RowBox[{"(*", 
                   RowBox[{
                   "Sum", " ", "over", " ", "all", " ", "the", " ", "spin", 
                    " ", "projections"}], "*)"}], 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Sum", "[", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Sum", " ", "over", " ", "all", " ", "the", " ", "m", " ",
                     "values", " ", "of", " ", "the", " ", "upper", " ", 
                    "component", " ", "of", " ", "the", " ", "final", " ", 
                    "state"}], "*)"}], 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ClebschGordan", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"lf", ",", "mlf"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    FractionBox["1", "2"], ",", "ms"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "mj"}], "}"}]}], "]"}], 
                    RowBox[{"ClebschGordan", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"lfp", ",", "mlfp"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    FractionBox["1", "2"], ",", "ms"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"jp", ",", "mj"}], "}"}]}], "]"}], 
                    RowBox[{"(*", 
                    RowBox[{
                    "Evaluate", " ", "the", " ", "integral", " ", "of", " ", 
                    "the", " ", "three", " ", "spherical", " ", "harmonics"}],
                     "*)"}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "mlfp"], 
                    RowBox[{"Gaunt", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"lf", ",", "mlf"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"lfp", ",", 
                    RowBox[{"-", "mlfp"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", ",", "0"}], "}"}]}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"mlf", ",", 
                    RowBox[{"-", "lf"}], ",", "lf"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"mlfp", ",", 
                    RowBox[{"-", "lfp"}], ",", "lfp"}], "}"}]}], 
                    RowBox[{"(*", 
                    RowBox[{
                    "The", " ", "orthonormality", " ", "of", " ", "the", " ", 
                    "spin", " ", "functions", " ", "have", " ", "removed", 
                    " ", "a", " ", "sum", " ", "over", " ", 
                    SubsuperscriptBox["m", "s", "'"]}], "*)"}], "]"}], "+", 
                    RowBox[{
                    SuperscriptBox["\[Zeta]", "2"], " ", 
                    RowBox[{"Sum", "[", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Add", " ", "the", " ", "same", " ", "but", " ", "for", 
                    " ", "the", " ", "lower", " ", "component"}], "*)"}], 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ClebschGordan", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"lg", ",", "mlg"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    FractionBox["1", "2"], ",", "ms"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "mj"}], "}"}]}], "]"}], 
                    RowBox[{"ClebschGordan", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"lgp", ",", "mlgp"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    FractionBox["1", "2"], ",", "ms"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"jp", ",", "mj"}], "}"}]}], "]"}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "mlgp"], 
                    RowBox[{"Gaunt", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"lg", ",", "mlg"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"lgp", ",", 
                    RowBox[{"-", "mlgp"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", ",", "0"}], "}"}]}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"mlg", ",", 
                    RowBox[{"-", "lg"}], ",", "lg"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"mlgp", ",", 
                    RowBox[{"-", "lgp"}], ",", "lgp"}], "}"}]}], "]"}]}]}], 
                   ",", 
                   RowBox[{"{", 
                    RowBox[{"ms", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    FractionBox["1", "2"]}], ",", 
                    FractionBox["1", "2"]}], "}"}]}], "}"}]}], "]"}], ")"}], 
                RowBox[{"Piecewise", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"{", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"Abs", "[", 
                    SubscriptBox["M", 
                    RowBox[{"\[Kappa]", ",", "k"}]], "]"}], "2"], ",", 
                    RowBox[{
                    RowBox[{"\[Kappa]", "\[Equal]", "\[Kappa]p"}], "&&", 
                    RowBox[{"k", "\[Equal]", "kp"}]}]}], "}"}], "}"}], ",", 
                  RowBox[{
                   SubscriptBox["M", 
                    RowBox[{"\[Kappa]", ",", "k"}]], 
                   RowBox[{"Conjugate", "[", 
                    SubscriptBox["M", 
                    RowBox[{"\[Kappa]p", ",", "kp"}]], "]"}]}]}], "]"}]}]}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"k", ",", "ks"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"kp", ",", "ks"}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"\[Kappa]", ",", "final\[Kappa]s"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Kappa]p", ",", "final\[Kappa]s"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"mj", ",", 
                RowBox[{"-", "j0"}], ",", "j0"}], "}"}]}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.85651325676006*^9, 3.8565133616771755`*^9}, {
   3.856513668372083*^9, 3.856513889156228*^9}, {3.856513922185759*^9, 
   3.856513958736478*^9}, {3.8565139941553845`*^9, 3.856514036808402*^9}, {
   3.856514286742508*^9, 3.856514289151479*^9}, {3.8565144056379175`*^9, 
   3.856514449933129*^9}, {3.856514584601562*^9, 3.856514647948613*^9}, {
   3.856514684589691*^9, 3.85651475588034*^9}, {3.856515028712118*^9, 
   3.85651508970306*^9}, {3.856515121341202*^9, 3.85651512497117*^9}, {
   3.8565152853867393`*^9, 3.856515297608778*^9}, {3.856515335748362*^9, 
   3.856515525204428*^9}, {3.856515589963394*^9, 3.856515625693228*^9}, {
   3.856516235510316*^9, 3.8565162613568597`*^9}, {3.856585382894991*^9, 
   3.8565854004407573`*^9}, {3.8565854328017383`*^9, 3.856585451922697*^9}, {
   3.856585911138662*^9, 3.8565860034248447`*^9}, {3.856586038250183*^9, 
   3.85658608665372*^9}, {3.8565861492997212`*^9, 3.856586195876028*^9}, {
   3.856587611022597*^9, 3.8565876611706247`*^9}, {3.856587706158799*^9, 
   3.8565878334905925`*^9}, {3.8565878874140835`*^9, 3.856587896924286*^9}, {
   3.856588964880172*^9, 3.856588986171868*^9}, 3.856591179078941*^9, {
   3.856591378973539*^9, 3.856591400070913*^9}, {3.8565915211646667`*^9, 
   3.8565915522409387`*^9}, {3.856591600984425*^9, 3.8565917149873133`*^9}, {
   3.8565919215293283`*^9, 3.856591922642407*^9}, {3.856592184682478*^9, 
   3.856592191043097*^9}, {3.8565922756639557`*^9, 3.8565923301291146`*^9}, {
   3.856592366337561*^9, 3.856592383773395*^9}, 3.856592446365761*^9, {
   3.856592532715927*^9, 3.856592539824321*^9}, {3.85659266942172*^9, 
   3.85659273063868*^9}, {3.856592761015329*^9, 3.85659277057174*^9}, {
   3.856592903512166*^9, 3.856593047506492*^9}, {3.856593104202016*^9, 
   3.856593170908279*^9}, {3.8565932095911126`*^9, 3.856593211166947*^9}, {
   3.8565932414119616`*^9, 3.8565934755755177`*^9}, {3.85659359894766*^9, 
   3.856593621769866*^9}, {3.856594059659815*^9, 3.856594079080967*^9}, {
   3.8565941156593547`*^9, 3.856594437228965*^9}, {3.856594486633009*^9, 
   3.856594712709358*^9}, {3.856595342750454*^9, 3.856595344805591*^9}, {
   3.856596491206972*^9, 3.856596510612398*^9}, {3.856596541338188*^9, 
   3.8565965472022552`*^9}, {3.8565967014964995`*^9, 
   3.8565967057141047`*^9}, {3.856596907934692*^9, 3.85659700818099*^9}, {
   3.856597236826782*^9, 3.856597277031934*^9}, {3.856598171345842*^9, 
   3.856598185443868*^9}, {3.856598254957188*^9, 3.856598344867979*^9}, 
   3.8565984404723234`*^9, {3.856600651165604*^9, 3.8566007354686947`*^9}, {
   3.856600797133131*^9, 3.856600824507434*^9}, {3.856600883605859*^9, 
   3.8566008917735596`*^9}, {3.856601000586862*^9, 3.856601029052081*^9}, {
   3.8566012080168066`*^9, 3.8566012109806957`*^9}, {3.85660142223667*^9, 
   3.856601444483134*^9}, 3.85660182646913*^9, {3.856845954113136*^9, 
   3.8568459639866943`*^9}, {3.856845996499361*^9, 3.856846014494037*^9}, {
   3.8568460485079975`*^9, 3.856846055387862*^9}, {3.856846088237724*^9, 
   3.856846101457393*^9}, {3.856850565041581*^9, 3.8568506043031487`*^9}, {
   3.856851164341922*^9, 3.856851171550708*^9}, {3.857106749147674*^9, 
   3.8571067597408843`*^9}, {3.8571074162696743`*^9, 3.857107448425512*^9}, {
   3.857449386733495*^9, 3.857449400949382*^9}, {3.857449504330572*^9, 
   3.857449568234949*^9}, 3.857449621982585*^9, 3.857458503989254*^9, {
   3.8589182448917837`*^9, 3.858918254440423*^9}, {3.859963651867974*^9, 
   3.859963887381262*^9}, {3.859963963674611*^9, 3.8599641044990964`*^9}, {
   3.859964203387518*^9, 3.8599643492145376`*^9}, {3.859964383013787*^9, 
   3.859964435408315*^9}, {3.859964478439386*^9, 3.8599645966446733`*^9}, {
   3.859964626648475*^9, 3.859964632784956*^9}, {3.859964692735917*^9, 
   3.8599647171545954`*^9}, {3.859964813305243*^9, 3.859964819156474*^9}, {
   3.859964865185267*^9, 3.85996486528524*^9}, {3.8599658118935547`*^9, 
   3.859965834526172*^9}, {3.859965937913013*^9, 3.859966103513031*^9}, {
   3.859966270180933*^9, 3.8599663087444367`*^9}, {3.859966463514054*^9, 
   3.8599665698894534`*^9}, {3.859966787159004*^9, 3.859966921310641*^9}, {
   3.859967054250846*^9, 3.8599670974786477`*^9}, {3.859967177433354*^9, 
   3.859967219559569*^9}, {3.8599673782764897`*^9, 3.8599673861662602`*^9}, {
   3.859967443487412*^9, 3.859967450299982*^9}, {3.8599675536434593`*^9, 
   3.8599676688544917`*^9}, {3.859967867346444*^9, 3.859967920578427*^9}, {
   3.8599679797327113`*^9, 3.859968007409665*^9}, {3.859968228402433*^9, 
   3.859968245530806*^9}, {3.859968449731025*^9, 3.8599686448371334`*^9}, 
   3.8599695467329173`*^9, {3.859969577820769*^9, 3.859969635720476*^9}, 
   3.859970046773533*^9, {3.860213990409752*^9, 3.860214015295046*^9}, {
   3.8602143318630705`*^9, 3.860214352189272*^9}, {3.8602144074751034`*^9, 
   3.860214449075412*^9}, {3.860214511201055*^9, 3.8602145404531*^9}, {
   3.860234637015193*^9, 3.860234646890469*^9}, {3.86411233089554*^9, 
   3.8641123362928677`*^9}, {3.8641202416812162`*^9, 3.864120241931485*^9}, {
   3.864203215951748*^9, 3.864203225379921*^9}, {3.864203340689619*^9, 
   3.864203359166275*^9}, {3.8644624700218983`*^9, 3.864462487340066*^9}, {
   3.8644625357704124`*^9, 3.864462537244047*^9}, {3.86446257156605*^9, 
   3.864462585865446*^9}, {3.8644626533836327`*^9, 3.864462667097728*^9}, {
   3.8644627274668164`*^9, 3.8644627392656603`*^9}, {3.8648017218463583`*^9, 
   3.8648017407075276`*^9}, {3.8648867129191513`*^9, 
   3.8648867304744396`*^9}, {3.86626501738667*^9, 3.866265027330153*^9}, {
   3.866265074536945*^9, 3.866265078056855*^9}, {3.8662651260377245`*^9, 
   3.866265204788305*^9}, {3.866265266036714*^9, 3.866265296198345*^9}, {
   3.8662653730680904`*^9, 3.866265375510013*^9}, {3.8662657733787146`*^9, 
   3.866265773959409*^9}, {3.866266211708043*^9, 3.866266212122843*^9}, {
   3.869708873078078*^9, 3.869708899833076*^9}, {3.869726750058719*^9, 
   3.869726762920429*^9}, {3.876221486209411*^9, 3.876221486855519*^9}, {
   3.904033421587858*^9, 3.904033425788714*^9}, {3.9143094726623764`*^9, 
   3.9143095350547085`*^9}, {3.914309695497978*^9, 3.9143097122483654`*^9}, {
   3.9143099418143845`*^9, 3.914309961255354*^9}, 3.9143110370693665`*^9, 
   3.914322807765108*^9},
 CellLabel->
  "In[232]:=",ExpressionUUID->"d2242f51-2ffa-4e6d-ba67-b3d6bcdf677c"],

Cell[TextData[{
 "In the next cell we compute the integrated cross section, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Beta]", "2"], TraditionalForm]],ExpressionUUID->
  "224bda96-259b-4f96-9512-98d2d1333f1a"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Beta]", "4"], TraditionalForm]],ExpressionUUID->
  "3e0da0ff-19e1-4c7b-9ae9-74918072b1ac"],
 " when starting from \[Kappa]=-1"
}], "Text",
 CellChangeTimes->{{3.8566017562805357`*^9, 3.856601797151787*^9}, {
  3.859966971904718*^9, 3.859966988484163*^9}, {3.8599677155103455`*^9, 
  3.8599677181646132`*^9}, {3.903774386061191*^9, 
  3.9037743900285378`*^9}},ExpressionUUID->"58c02ceb-592a-41cd-bb05-\
da839b0547a5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  FractionBox["1", 
   RowBox[{"1", "+", 
    SuperscriptBox["\[Zeta]", "2"]}]], 
  RowBox[{"RelativisticAsymmetryParameter", "[", 
   RowBox[{"0", ",", 
    RowBox[{"-", "1"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"RelativisticAsymmetryParameter", "[", 
  RowBox[{"2", ",", 
   RowBox[{"-", "1"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"RelativisticAsymmetryParameter", "[", 
  RowBox[{"4", ",", 
   RowBox[{"-", "1"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.903774393633106*^9, 3.903774404929378*^9}, 
   3.904034017778947*^9},
 CellLabel->"In[22]:=",ExpressionUUID->"b94cb76b-bed3-4353-a6c4-4445e5e79e6e"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "5"], " ", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"Abs", "[", 
      SubscriptBox["M", 
       RowBox[{
        RowBox[{"-", "3"}], ",", "2"}]], "]"}], "2"], "+", 
    RowBox[{"5", " ", 
     SuperscriptBox[
      RowBox[{"Abs", "[", 
       SubscriptBox["M", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "0"}]], "]"}], "2"]}], "+", 
    SuperscriptBox[
     RowBox[{"Abs", "[", 
      SubscriptBox["M", 
       RowBox[{"2", ",", "2"}]], "]"}], "2"]}], ")"}]}]], "Output",
 CellChangeTimes->{3.903774408468955*^9, 3.90403402527854*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"f1a7bd77-b0a6-49d2-9b82-473894f64354"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"7", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"Abs", "[", 
        SubscriptBox["M", 
         RowBox[{
          RowBox[{"-", "3"}], ",", "2"}]], "]"}], "2"], "+", 
      RowBox[{"5", " ", 
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         SubscriptBox["M", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "0"}]], "]"}], "2"]}], "+", 
      SuperscriptBox[
       RowBox[{"Abs", "[", 
        SubscriptBox["M", 
         RowBox[{"2", ",", "2"}]], "]"}], "2"]}], ")"}]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"8", " ", 
     SuperscriptBox[
      RowBox[{"Abs", "[", 
       SubscriptBox["M", 
        RowBox[{
         RowBox[{"-", "3"}], ",", "2"}]], "]"}], "2"]}], "+", 
    RowBox[{"7", " ", 
     SuperscriptBox[
      RowBox[{"Abs", "[", 
       SubscriptBox["M", 
        RowBox[{"2", ",", "2"}]], "]"}], "2"]}], "+", 
    RowBox[{"7", " ", 
     SqrtBox["15"], " ", 
     RowBox[{"Conjugate", "[", 
      SubscriptBox["M", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "0"}]], "]"}], " ", 
     SubscriptBox["M", 
      RowBox[{
       RowBox[{"-", "3"}], ",", "2"}]]}], "+", 
    RowBox[{
     SqrtBox["6"], " ", 
     RowBox[{"Conjugate", "[", 
      SubscriptBox["M", 
       RowBox[{"2", ",", "2"}]], "]"}], " ", 
     SubscriptBox["M", 
      RowBox[{
       RowBox[{"-", "3"}], ",", "2"}]]}], "+", 
    RowBox[{"7", " ", 
     SqrtBox["15"], " ", 
     RowBox[{"Conjugate", "[", 
      SubscriptBox["M", 
       RowBox[{
        RowBox[{"-", "3"}], ",", "2"}]], "]"}], " ", 
     SubscriptBox["M", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0"}]]}], "+", 
    RowBox[{"7", " ", 
     SqrtBox["10"], " ", 
     RowBox[{"Conjugate", "[", 
      SubscriptBox["M", 
       RowBox[{"2", ",", "2"}]], "]"}], " ", 
     SubscriptBox["M", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0"}]]}], "+", 
    RowBox[{
     SqrtBox["6"], " ", 
     RowBox[{"Conjugate", "[", 
      SubscriptBox["M", 
       RowBox[{
        RowBox[{"-", "3"}], ",", "2"}]], "]"}], " ", 
     SubscriptBox["M", 
      RowBox[{"2", ",", "2"}]]}], "+", 
    RowBox[{"7", " ", 
     SqrtBox["10"], " ", 
     RowBox[{"Conjugate", "[", 
      SubscriptBox["M", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "0"}]], "]"}], " ", 
     SubscriptBox["M", 
      RowBox[{"2", ",", "2"}]]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.903774408468955*^9, 3.904034041823975*^9},
 CellLabel->"Out[23]=",ExpressionUUID->"8bcc8f7d-aba6-46a8-ac03-a3d3856122af"],

Cell[BoxData[
 FractionBox[
  RowBox[{"6", " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"Abs", "[", 
       SubscriptBox["M", 
        RowBox[{
         RowBox[{"-", "3"}], ",", "2"}]], "]"}], "2"], "+", 
     RowBox[{
      SqrtBox["6"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Conjugate", "[", 
          SubscriptBox["M", 
           RowBox[{"2", ",", "2"}]], "]"}], " ", 
         SubscriptBox["M", 
          RowBox[{
           RowBox[{"-", "3"}], ",", "2"}]]}], "+", 
        RowBox[{
         RowBox[{"Conjugate", "[", 
          SubscriptBox["M", 
           RowBox[{
            RowBox[{"-", "3"}], ",", "2"}]], "]"}], " ", 
         SubscriptBox["M", 
          RowBox[{"2", ",", "2"}]]}]}], ")"}]}]}], ")"}]}], 
  RowBox[{"7", " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"Abs", "[", 
       SubscriptBox["M", 
        RowBox[{
         RowBox[{"-", "3"}], ",", "2"}]], "]"}], "2"], "+", 
     RowBox[{"5", " ", 
      SuperscriptBox[
       RowBox[{"Abs", "[", 
        SubscriptBox["M", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "0"}]], "]"}], "2"]}], "+", 
     SuperscriptBox[
      RowBox[{"Abs", "[", 
       SubscriptBox["M", 
        RowBox[{"2", ",", "2"}]], "]"}], "2"]}], ")"}]}]]], "Output",
 CellChangeTimes->{3.903774408468955*^9, 3.9040340566318173`*^9},
 CellLabel->"Out[24]=",ExpressionUUID->"6a0f81f6-cb1a-49cd-af80-33dcc9c42d3e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Non-relativistic formula", "Section",
 CellChangeTimes->{{3.8574604783074083`*^9, 3.857460483628612*^9}, 
   3.857460555718*^9},ExpressionUUID->"3060e96d-43dd-4a0d-b603-e3ee95521454"],

Cell["\<\
This formula computes the asymmetry parameters for a non-relativistic one or \
two photon process where the photons can have one of three polarizations: \
left circular in the xy-plane, linear along the z-axis, and right circular in \
the xy-plane.\
\>", "Text",
 CellChangeTimes->{{3.857460519001053*^9, 3.857460552474*^9}, {
  3.903773063297475*^9, 
  3.9037731187545605`*^9}},ExpressionUUID->"cf72bc2f-a5e0-4c2e-bbc7-\
5a6137909ed5"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "AsymmetryParameter", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "AsymmetryParameter", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Normalize", "\[Rule]", "True"}], ",", " ", 
     RowBox[{"Terms", "->", 
      RowBox[{"{", 
       RowBox[{
       "\"\<aa\>\"", ",", "\"\<ee\>\"", ",", "\"\<ae\>\"", ",", 
        "\"\<ea\>\""}], "}"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AsymmetryParameter", "::", "badoptval"}], "=", 
   "\"\<`1` is not a valid value for option `2`\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AsymmetryParameter", "::", "usage"}], "=", 
   "\"\<Computes the asymmetry parameter \!\(\*SubscriptBox[\(\[Beta]\), \(lm\
\)]\) for the given one or two photon (RABBIT) process. \
\!\(\*SubscriptBox[\(l\), \(0\)]\) is the orbital quantum number of the \
initial state, and qs is a list of one or two elements corresponding to the \
polarization of the photons: -1 for left circularly polarized in the \
xy-plane, 0 for linearly polarized along the z-axis, and 1 for right \
circularly polarized in the xy-plane. If qs has two elements, the second is \
the polarization of the IR photon, and can thus be both absorbed and emitted.\
\nThe option Normalize can be set to False to avoid dividing out the \
integrated cross section, \!\(\*SubscriptBox[\(\[Sigma]\), \(0\)]\).\nThe \
option Terms can be set to any subset of {\\\"aa\\\",\\\"ee\\\",\\\"ae\\\",\\\
\"ea\\\"} to include only the contribution from those terms.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AsymmetryParameter", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"l_Integer", ",", "m_Integer"}], "}"}], ",", "l0_Integer", ",", 
     "qs_List", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"l", "\[GreaterEqual]", "0"}], "&&", 
    RowBox[{
     RowBox[{"Abs", "[", "m", "]"}], "\[LessEqual]", "l"}], "&&", 
    RowBox[{"l0", "\[GreaterEqual]", "0"}], "&&", 
    RowBox[{"AllTrue", "[", 
     RowBox[{"qs", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"IntegerQ", "[", "#", "]"}], "&&", 
        RowBox[{
         RowBox[{"Abs", "[", "#", "]"}], "\[LessEqual]", "1"}]}], "&"}]}], 
     "]"}], "&&", 
    RowBox[{
     RowBox[{"Length", "[", "qs", "]"}], "\[LessEqual]", "2"}]}]}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "photons", ",", "terms", ",", "termsPresent", ",", "physicalLs", ",", 
      "q1", ",", "q2", ",", "normalize", ",", "error", ",", "Term"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"photons", "=", 
      RowBox[{"Length", "[", "qs", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"normalize", "=", 
      RowBox[{"OptionValue", "[", "Normalize", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"terms", "=", 
      RowBox[{"OptionValue", "[", "Terms", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Error", " ", "handling"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"error", "=", "False"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"VectorQ", "[", "terms", "]"}], "&&", 
          RowBox[{"AllTrue", "[", 
           RowBox[{"terms", ",", "StringQ"}], "]"}]}], ")"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"AsymmetryParameter", "::", "badoptval"}], ",", "terms", 
          ",", "Terms"}], "]"}], ";", 
        RowBox[{"error", "=", "True"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"BooleanQ", "[", "normalize", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"AsymmetryParameter", "::", "badoptval"}], ",", "normalize",
           ",", "Normalize"}], "]"}], ";", 
        RowBox[{"error", "=", "True"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"termsPresent", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Boole", "[", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"terms", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{
        "\"\<aa\>\"", ",", "\"\<ee\>\"", ",", "\"\<ae\>\"", ",", 
         "\"\<ea\>\""}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", "error"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Quiet", "@", 
        RowBox[{"FullSimplify", "[", 
         RowBox[{
          RowBox[{
           SqrtBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", "l"}], "+", "1"}], ")"}], "4", "\[Pi]"}]], 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"l", ">", "0"}], "&&", "normalize"}], ",", 
             FractionBox["1", 
              RowBox[{"AsymmetryParameter", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}], ",", "l0", ",", "qs", ",", 
                RowBox[{"Terms", "->", "terms"}]}], "]"}]], ",", "1"}], "]"}],
            "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"photons", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"One", " ", "photon"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"q1", "=", 
               RowBox[{
               "qs", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
               ";", "\[IndentingNewLine]", 
              RowBox[{"physicalLs", "=", 
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"l0", "-", "1"}], ",", 
                   RowBox[{"l0", "+", "1"}]}], "}"}], ",", "NonNegative"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"Sum", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Sum", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], 
                    RowBox[{"lf", "-", "m0", "-", "q1"}]], 
                   RowBox[{"ThreeJSymbol", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"lf", ",", 
                    RowBox[{
                    RowBox[{"-", "m0"}], "-", "q1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "q1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"l0", ",", "m0"}], "}"}]}], "]"}], 
                   RowBox[{"Piecewise", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"Abs", "[", 
                    SubscriptBox["M", "lf"], "]"}], "2"], ",", 
                    RowBox[{"lf", "\[Equal]", "lfp"}]}], "}"}], "}"}], ",", 
                    RowBox[{
                    SubscriptBox["M", "lf"], 
                    RowBox[{"Conjugate", "[", 
                    SubscriptBox["M", "lfp"], "]"}]}]}], "]"}], 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], 
                    RowBox[{"lfp", "-", "m0", "-", "q1"}]], 
                   RowBox[{"ThreeJSymbol", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"lfp", ",", 
                    RowBox[{
                    RowBox[{"-", "m0"}], "-", "q1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "q1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"l0", ",", "m0"}], "}"}]}], "]"}], 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], 
                    RowBox[{"m", "+", "m0", "+", "q1"}]], 
                   RowBox[{"Gaunt", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"lf", ",", 
                    RowBox[{"m0", "+", "q1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"lfp", ",", 
                    RowBox[{
                    RowBox[{"-", "m0"}], "-", "q1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"l", ",", 
                    RowBox[{"-", "m"}]}], "}"}]}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"lf", ",", "physicalLs"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"lfp", ",", "physicalLs"}], "}"}]}], 
                 "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"m0", ",", 
                  RowBox[{"-", "l0"}], ",", "l0"}], "}"}]}], 
               "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ",", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"Two", " ", "photons"}], ",", " ", "coupled"}], "*)"}],
              "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"q1", "=", 
               RowBox[{
               "qs", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
               ";", "\[IndentingNewLine]", 
              RowBox[{"q2", "=", 
               RowBox[{
               "qs", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
               ";", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{
                 RowBox[{"Since", " ", "A"}], "=", 
                 RowBox[{
                  RowBox[{"|", 
                   RowBox[{
                    SubscriptBox["A", "a"], "+", 
                    SubscriptBox["A", "e"]}], 
                   SuperscriptBox["|", "2"]}], "=", 
                  RowBox[{"|", 
                   SubscriptBox["A", "a"], 
                   SuperscriptBox["|", "2"], 
                   RowBox[{"+", 
                    RowBox[{"|", 
                    SubscriptBox["A", "e"], 
                    SuperscriptBox["|", "2"], 
                    RowBox[{
                    RowBox[{
                    RowBox[{"+", 
                    SubsuperscriptBox["A", "a", "*"]}], 
                    SubscriptBox["A", "e"]}], "+", 
                    RowBox[{
                    SubsuperscriptBox["A", "e", "*"], 
                    SubscriptBox["A", "a"]}]}]}]}]}]}]}], ",", " ", 
                RowBox[{
                "and", " ", "the", " ", "m", " ", "value", " ", "of", " ", 
                 "the", " ", "final", " ", "electron", " ", "is", " ", 
                 "different", " ", "in", " ", "absorption", " ", "and", " ", 
                 "emission", " ", "we", " ", "have", " ", "to", " ", 
                 "compute", " ", "each", " ", "of", " ", "these", " ", "four",
                  " ", "terms", " ", "one", " ", "by", " ", 
                 RowBox[{"one", ".", " ", "However"}]}], ",", " ", 
                RowBox[{
                "they", " ", "follow", " ", "a", " ", "pattern", " ", "which",
                  " ", "is", " ", "described", " ", "by", " ", "`Term`", " ", 
                 "below"}]}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"Term", "[", 
                 RowBox[{"patha_", ",", "pathb_"}], "]"}], "/;", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"patha", "==", "\"\<a\>\""}], "||", 
                   RowBox[{"patha", "==", "\"\<e\>\""}]}], ")"}], "&&", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"pathb", "==", "\"\<a\>\""}], "||", 
                   RowBox[{"pathb", "==", "\"\<e\>\""}]}], ")"}]}]}], ":=", 
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"q2a", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"patha", "==", "\"\<a\>\""}], ",", "q2", ",", 
                    RowBox[{"-", "q2"}]}], "]"}]}], ",", 
                   RowBox[{"q2b", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"pathb", "==", "\"\<a\>\""}], ",", "q2", ",", 
                    RowBox[{"-", "q2"}]}], "]"}]}]}], "}"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                  "The", " ", "first", " ", "phase", " ", "is", " ", "from", 
                   " ", "the", " ", "conversion", " ", "of", " ", 
                   SubscriptBox["Y", "lm"], "s", " ", "to", " ", "the", " ", 
                   "form", " ", "used", " ", "in", " ", "the", " ", 
                   "definition", " ", "of", " ", "`Gaunt`"}], "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], 
                   RowBox[{"m", "+", "m0", "+", "q1", "+", "q2a"}]], 
                  RowBox[{"Gaunt", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"l", ",", 
                    RowBox[{"-", "m"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"lf", ",", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"m0", "+", "q1", "+", "q2a"}], ")"}]}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"lfp", ",", 
                    RowBox[{"m0", "+", "q1", "+", "q2b"}]}], "}"}]}], "]"}], 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], 
                   RowBox[{"lf", "+", "lfp"}]], "\[IndentingNewLine]", 
                  RowBox[{"ThreeJSymbol", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"lf", ",", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"m0", "+", "q1", "+", "q2a"}], ")"}]}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", 
                    RowBox[{"q1", "+", "q2a"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"l0", ",", "m0"}], "}"}]}], "]"}], 
                  RowBox[{"ThreeJSymbol", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"lfp", ",", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"m0", "+", "q1", "+", "q2b"}], ")"}]}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"kp", ",", 
                    RowBox[{"q1", "+", "q2b"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"l0", ",", "m0"}], "}"}]}], "]"}], 
                  RowBox[{"ThreeJSymbol", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "q2a"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "q1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"q1", "+", "q2a"}], ")"}]}]}], "}"}]}], "]"}], 
                  RowBox[{"ThreeJSymbol", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "q2b"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "q1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"kp", ",", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"q1", "+", "q2b"}], ")"}]}]}], "}"}]}], "]"}], 
                  RowBox[{"Piecewise", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"Abs", "[", 
                    SubscriptBox["M", 
                    RowBox[{"patha", ",", "lf", ",", "k"}]], "]"}], "2"], ",", 
                    RowBox[{
                    RowBox[{"patha", "==", "pathb"}], "&&", 
                    RowBox[{"lf", "==", "lfp"}], "&&", 
                    RowBox[{"k", "==", "kp"}]}]}], "}"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"Conjugate", "[", 
                    SubscriptBox["M", 
                    RowBox[{"patha", ",", "lf", ",", "k"}]], "]"}], 
                    SubscriptBox["M", 
                    RowBox[{"pathb", ",", "lfp", ",", "kp"}]]}]}], "]"}]}]}], 
                "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"It", "'"}], "s", " ", "possible", " ", "that", " ", 
                  SubscriptBox["l", "0"]}], "-", 
                 RowBox[{
                 "2", " ", "is", " ", "negative", " ", "depending", " ", "on",
                   " ", "the", " ", "initial", " ", 
                  SubscriptBox["l", "0"]}]}], ",", " ", 
                RowBox[{
                "so", " ", "we", " ", "filter", " ", "it", " ", "out", " ", 
                 "if", " ", "it", " ", "is"}]}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"physicalLs", "=", 
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"l0", "-", "2"}], ",", "l0", ",", 
                   RowBox[{"l0", "+", "2"}]}], "}"}], ",", "NonNegative"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{"Sum", " ", "coherently", " ", "over", " ", 
                SubscriptBox["l", "f"], " ", "and", " ", "incoherently", " ", 
                "over", " ", 
                SubscriptBox["m", "0"]}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"Sum", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Sum", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"termsPresent", ".", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Term", "[", 
                    RowBox[{"\"\<a\>\"", ",", "\"\<a\>\""}], "]"}], ",", 
                    RowBox[{"Term", "[", 
                    RowBox[{"\"\<e\>\"", ",", "\"\<e\>\""}], "]"}], ",", 
                    RowBox[{"Term", "[", 
                    RowBox[{"\"\<a\>\"", ",", "\"\<e\>\""}], "]"}], ",", 
                    RowBox[{"Term", "[", 
                    RowBox[{"\"\<e\>\"", ",", "\"\<a\>\""}], "]"}]}], "}"}]}],
                   ",", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"lf", ",", "physicalLs"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"lfp", ",", "physicalLs"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"k", ",", "0", ",", "2"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"kp", ",", "0", ",", "2"}], "}"}]}], 
                 "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"m0", ",", 
                  RowBox[{"-", "l0"}], ",", "l0"}], "}"}]}], 
               "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
            "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"TransformationFunctions", "->", 
           RowBox[{"{", 
            RowBox[{"Automatic", ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
                RowBox[{
                "Sum", " ", "the", " ", "absorbtion", " ", "and", " ", 
                 "emission", " ", "paths", " ", 
                 SubscriptBox["M", 
                  RowBox[{"a", ",", "bla"}]]}], "+", 
                SubscriptBox["M", 
                 RowBox[{"e", ",", "bla"}]]}], "=", 
               SubscriptBox["M", "bla"]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"#", "/.", 
               RowBox[{
                RowBox[{
                 SubscriptBox["M", 
                  RowBox[{"a_", ",", "lf_", ",", "k_"}]], "+", 
                 SubscriptBox["M", 
                  RowBox[{"e_", ",", "lf_", ",", "k_"}]]}], "->", 
                SubscriptBox["M", 
                 RowBox[{"lf", ",", "k"}]]}]}], "&"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"#", "/.", 
               RowBox[{
                RowBox[{
                 RowBox[{"Conjugate", "[", 
                  SubscriptBox["M", 
                   RowBox[{"a_", ",", "lf_", ",", "k_"}]], "]"}], "+", 
                 RowBox[{"Conjugate", "[", 
                  SubscriptBox["M", 
                   RowBox[{"e_", ",", "lf_", ",", "k_"}]], "]"}]}], "->", 
                RowBox[{"Conjugate", "[", 
                 SubscriptBox["M", 
                  RowBox[{"lf", ",", "k"}]], "]"}]}]}], "&"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"#", "/.", 
               RowBox[{
                RowBox[{
                 RowBox[{"f_", " ", 
                  SubscriptBox["M", 
                   RowBox[{"a_", ",", "lf_", ",", "k_"}]]}], "+", 
                 RowBox[{"f_", " ", 
                  SubscriptBox["M", 
                   RowBox[{"e_", ",", "lf_", ",", "k_"}]]}]}], "->", 
                RowBox[{"f", " ", 
                 SubscriptBox["M", 
                  RowBox[{"lf", ",", "k"}]]}]}]}], "&"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"#", "/.", 
               RowBox[{
                RowBox[{
                 RowBox[{"f_", " ", 
                  RowBox[{"Conjugate", "[", 
                   SubscriptBox["M", 
                    RowBox[{"a_", ",", "lf_", ",", "k_"}]], "]"}]}], "+", 
                 RowBox[{"f_", " ", 
                  RowBox[{"Conjugate", "[", 
                   SubscriptBox["M", 
                    RowBox[{"e_", ",", "lf_", ",", "k_"}]], "]"}]}]}], "->", 
                RowBox[{"f", " ", 
                 RowBox[{"Conjugate", "[", 
                  SubscriptBox["M", 
                   RowBox[{"lf", ",", "k"}]], "]"}]}]}]}], "&"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"Re", "-", 
                RowBox[{"express", " ", 
                 SuperscriptBox["x", "*"], "x", " ", "as"}]}], " ", "|", "x", 
               SuperscriptBox["|", "2"]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"#", "/.", 
               RowBox[{
                RowBox[{
                 RowBox[{"Conjugate", "[", "x_", "]"}], "x_"}], "->", 
                SuperscriptBox[
                 RowBox[{"Abs", "[", "x", "]"}], "2"]}]}], "&"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"#", "/.", 
               RowBox[{
                RowBox[{"f_", " ", 
                 RowBox[{"Conjugate", "[", "x_", "]"}], "x_"}], "->", 
                RowBox[{"f", " ", 
                 SuperscriptBox[
                  RowBox[{"Abs", "[", "x", "]"}], "2"]}]}]}], "&"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"#", "/.", 
               RowBox[{
                FractionBox["f_", 
                 RowBox[{
                  RowBox[{"Conjugate", "[", "x_", "]"}], "x_"}]], "->", 
                FractionBox["f", 
                 SuperscriptBox[
                  RowBox[{"Abs", "[", "x", "]"}], "2"]]}]}], "&"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"Merge", " ", "|", 
               SubscriptBox["M", "a"], 
               SuperscriptBox["|", "2"], 
               RowBox[{"+", 
                RowBox[{"|", 
                 SubscriptBox["M", "e"], 
                 SuperscriptBox["|", "2"], 
                 RowBox[{
                  RowBox[{
                   RowBox[{"+", 
                    SubsuperscriptBox["M", "a", "*"]}], 
                   SubscriptBox["M", "e"]}], "+", 
                  RowBox[{
                   SubsuperscriptBox["M", "e", "*"], 
                   SubscriptBox["M", "a"], " ", "into"}]}], " ", "|", 
                 RowBox[{
                  SubscriptBox["M", "a"], "+", 
                  SubscriptBox["M", "e"]}], 
                 SuperscriptBox["|", "2"]}]}]}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"#", "/.", 
               RowBox[{
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"Abs", "[", 
                   SubscriptBox["M", 
                    RowBox[{"a_", ",", "lf_", ",", "k_"}]], "]"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"Abs", "[", 
                   SubscriptBox["M", 
                    RowBox[{"e_", ",", "lf_", ",", "k_"}]], "]"}], "2"], "+", 
                 RowBox[{
                  RowBox[{"Conjugate", "[", 
                   SubscriptBox["M", 
                    RowBox[{"a_", ",", "lf_", ",", "k_"}]], "]"}], 
                  SubscriptBox["M", 
                   RowBox[{"e_", ",", "lf_", ",", "k_"}]]}], "+", 
                 RowBox[{
                  RowBox[{"Conjugate", "[", 
                   SubscriptBox["M", 
                    RowBox[{"e_", ",", "lf_", ",", "k_"}]], "]"}], 
                  SubscriptBox["M", 
                   RowBox[{"a_", ",", "lf_", ",", "k_"}]]}]}], "->", 
                SuperscriptBox[
                 RowBox[{"Abs", "[", 
                  SubscriptBox["M", 
                   RowBox[{"lf", ",", "k"}]], "]"}], "2"]}]}], "&"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"#", "/.", 
               RowBox[{
                RowBox[{
                 RowBox[{"f_", " ", 
                  SuperscriptBox[
                   RowBox[{"Abs", "[", 
                    SubscriptBox["M", 
                    RowBox[{"a_", ",", "lf_", ",", "k_"}]], "]"}], "2"]}], 
                 "+", 
                 RowBox[{"f_", " ", 
                  SuperscriptBox[
                   RowBox[{"Abs", "[", 
                    SubscriptBox["M", 
                    RowBox[{"e_", ",", "lf_", ",", "k_"}]], "]"}], "2"]}], 
                 "+", 
                 RowBox[{"f_", " ", 
                  RowBox[{"Conjugate", "[", 
                   SubscriptBox["M", 
                    RowBox[{"a_", ",", "lf_", ",", "k_"}]], "]"}], 
                  SubscriptBox["M", 
                   RowBox[{"e_", ",", "lf_", ",", "k_"}]]}], "+", 
                 RowBox[{"f_", " ", 
                  RowBox[{"Conjugate", "[", 
                   SubscriptBox["M", 
                    RowBox[{"e_", ",", "lf_", ",", "k_"}]], "]"}], 
                  SubscriptBox["M", 
                   RowBox[{"a_", ",", "lf_", ",", "k_"}]]}]}], "->", 
                RowBox[{"f", " ", 
                 SuperscriptBox[
                  RowBox[{"Abs", "[", 
                   SubscriptBox["M", 
                    RowBox[{"lf", ",", "k"}]], "]"}], "2"]}]}]}], "&"}]}], 
            "}"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.855376423262329*^9, 3.855376553599177*^9}, {
   3.855376709007782*^9, 3.855377190087598*^9}, {3.855377224092099*^9, 
   3.855377547605261*^9}, {3.8553776279006557`*^9, 3.8553776719341297`*^9}, {
   3.855377735267762*^9, 3.855377744997863*^9}, {3.855377972984707*^9, 
   3.8553782158263025`*^9}, {3.85537834494168*^9, 3.85537843976874*^9}, {
   3.855378471000159*^9, 3.855378475290657*^9}, {3.8553785117913632`*^9, 
   3.855378732487031*^9}, {3.855378769836553*^9, 3.855379233283722*^9}, {
   3.855379556867055*^9, 3.855379629935792*^9}, {3.8553817415988994`*^9, 
   3.85538176272996*^9}, {3.8553818803590965`*^9, 3.855381880564925*^9}, {
   3.855381947247517*^9, 3.855381959248352*^9}, {3.855382091345642*^9, 
   3.8553821130051427`*^9}, {3.855382150091105*^9, 3.85538220481371*^9}, {
   3.855382472519924*^9, 3.855382490819488*^9}, {3.855382526493079*^9, 
   3.855382529995123*^9}, {3.855384967763594*^9, 3.8553851133170137`*^9}, {
   3.855385162101576*^9, 3.8553851760280533`*^9}, {3.855385214818502*^9, 
   3.8553852331084023`*^9}, {3.85538583510227*^9, 3.8553858407639613`*^9}, {
   3.855385900368113*^9, 3.855385942919509*^9}, {3.8553863925994883`*^9, 
   3.855386423779096*^9}, {3.855388249478784*^9, 3.855388271324179*^9}, {
   3.855388310732117*^9, 3.855388314743971*^9}, {3.85538834740308*^9, 
   3.855388351274842*^9}, {3.8553884879813557`*^9, 3.855388592478882*^9}, {
   3.855388823381505*^9, 3.855388826767488*^9}, {3.857460243708937*^9, 
   3.8574603646621757`*^9}, {3.857460488942813*^9, 3.857460498509354*^9}, {
   3.857535445863313*^9, 3.857535466157738*^9}, {3.8575440475438204`*^9, 
   3.8575440615645847`*^9}, {3.8575441236288834`*^9, 
   3.8575442863801546`*^9}, {3.857544337468859*^9, 3.857544337608325*^9}, {
   3.858918269437248*^9, 3.858918275990923*^9}, {3.876221454140888*^9, 
   3.876221456234408*^9}, {3.903771597054169*^9, 3.903771678190771*^9}, {
   3.903771717659491*^9, 3.903771781126569*^9}, {3.903771813252127*^9, 
   3.903771933572314*^9}, {3.9037719705411406`*^9, 3.903772025385478*^9}, {
   3.9037720670661697`*^9, 3.9037720754408436`*^9}, {3.903772115933973*^9, 
   3.9037721186650767`*^9}, {3.903772169180288*^9, 3.9037722125443172`*^9}, {
   3.9037722537997093`*^9, 3.9037723068700647`*^9}, {3.903772360531019*^9, 
   3.903772360916747*^9}, {3.903772444067358*^9, 3.9037724480574636`*^9}, {
   3.903772523664917*^9, 3.903772537359475*^9}, {3.903772604115545*^9, 
   3.903772605020438*^9}, {3.903772654992818*^9, 3.9037726690301704`*^9}, 
   3.903772777948369*^9, 3.903772811207174*^9, {3.903772871926546*^9, 
   3.9037728728475957`*^9}, {3.9037729348908377`*^9, 3.9037730043908362`*^9}, 
   3.903773034549225*^9, 3.903773144861007*^9, {3.903773270795579*^9, 
   3.9037733157429047`*^9}, {3.903773365675491*^9, 3.903773372355281*^9}, {
   3.903773405900335*^9, 3.90377343513291*^9}, {3.903773510301093*^9, 
   3.9037735116221733`*^9}, {3.9037772573106985`*^9, 3.903777261422624*^9}, {
   3.9041211722363467`*^9, 3.904121182482983*^9}, {3.904121336680174*^9, 
   3.9041213424272475`*^9}, {3.904121376134694*^9, 3.904121386220325*^9}, {
   3.904121428086996*^9, 3.904121434454753*^9}, {3.9043738646851015`*^9, 
   3.9043738740145946`*^9}, {3.904374000982982*^9, 3.90437401365251*^9}, {
   3.904374291329959*^9, 3.904374383089705*^9}, {3.904374453955857*^9, 
   3.9043744585076942`*^9}, {3.9043763856816216`*^9, 3.904376386466048*^9}, {
   3.904376844253594*^9, 3.904376951551684*^9}, {3.904378820825828*^9, 
   3.904378862060136*^9}, {3.904378966413434*^9, 3.904378981744198*^9}, {
   3.9043790797297087`*^9, 3.90437912704826*^9}, {3.904379230324274*^9, 
   3.904379271290007*^9}, {3.9043793085488396`*^9, 3.904379359056916*^9}, {
   3.904379390885932*^9, 3.9043794447939262`*^9}, {3.9043795087521734`*^9, 
   3.904379540786486*^9}, {3.904379680549973*^9, 3.904379697341426*^9}, {
   3.904379758591729*^9, 3.90437989829856*^9}, {3.904379974939338*^9, 
   3.9043799792343283`*^9}, {3.9043800634718065`*^9, 3.904380189517723*^9}, {
   3.904380234492454*^9, 3.904380235097892*^9}, {3.904380265196455*^9, 
   3.904380267283822*^9}, {3.904380311977264*^9, 3.9043803354622355`*^9}, {
   3.9043803943880877`*^9, 3.904380395672237*^9}, {3.90438043126835*^9, 
   3.904380519108973*^9}, {3.90479227034544*^9, 3.9047922763166056`*^9}},
 CellLabel->
  "In[104]:=",ExpressionUUID->"b4f86bd9-8ab6-4646-b512-03abc1eb8506"],

Cell[TextData[{
 "In the next cell we compute ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Sigma]", "0"], TraditionalForm]],ExpressionUUID->
  "d4601808-bfcb-43a8-a088-0061e1ca0af7"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Beta]", 
    RowBox[{"2", ",", "0"}]], TraditionalForm]],ExpressionUUID->
  "5cee5495-4c5c-4e4d-9097-6e20c683efe0"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Beta]", 
    RowBox[{"4", ",", "0"}]], TraditionalForm]],ExpressionUUID->
  "d82ce968-47dd-4e9b-901e-c64fbe38c605"],
 " for an electron that starts from an s-orbital and interacts with linearly \
polarized light"
}], "Text",
 CellChangeTimes->{{3.903774458374201*^9, 3.903774546685466*^9}, {
  3.903778551003754*^9, 
  3.9037785567705197`*^9}},ExpressionUUID->"8e7d231b-d47b-40b6-82a3-\
ceba24ace8ba"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"AsymmetryParameter", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", "0", ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"AsymmetryParameter", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "0"}], "}"}], ",", "0", ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"AsymmetryParameter", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"4", ",", "0"}], "}"}], ",", "0", ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.903774510267386*^9, 3.9037745186943803`*^9}, {
   3.903774550857062*^9, 3.903774588136284*^9}, {3.903774644542359*^9, 
   3.903774674954419*^9}, 3.903777268803628*^9, {3.90377833354608*^9, 
   3.9037783337471976`*^9}},
 CellLabel->
  "In[128]:=",ExpressionUUID->"d3c789fb-bd8c-4f7e-a0be-725d349a7957"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "3"], " ", 
   SuperscriptBox[
    RowBox[{"Abs", "[", 
     SubscriptBox["M", 
      RowBox[{"0", ",", "0"}]], "]"}], "2"]}], "+", 
  RowBox[{
   FractionBox["2", "75"], " ", 
   SuperscriptBox[
    RowBox[{"Abs", "[", 
     SubscriptBox["M", 
      RowBox[{"2", ",", "2"}]], "]"}], "2"]}]}]], "Output",
 CellChangeTimes->{{3.903774549160446*^9, 3.903774588795656*^9}, {
   3.903774645508664*^9, 3.903774675354391*^9}, 3.903776902557026*^9, {
   3.903777264484394*^9, 3.903777269289261*^9}, 3.903778334461953*^9, 
   3.9041213525582743`*^9, 3.904121437447144*^9},
 CellLabel->
  "Out[128]=",ExpressionUUID->"05d172c4-1b6d-46f8-8abd-501c0f8892cf"],

Cell[BoxData[
 FractionBox[
  RowBox[{"5", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"4", " ", 
      SuperscriptBox[
       RowBox[{"Abs", "[", 
        SubscriptBox["M", 
         RowBox[{"2", ",", "2"}]], "]"}], "2"]}], "-", 
     RowBox[{"7", " ", 
      SqrtBox["10"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Conjugate", "[", 
          SubscriptBox["M", 
           RowBox[{"2", ",", "2"}]], "]"}], " ", 
         SubscriptBox["M", 
          RowBox[{"0", ",", "0"}]]}], "+", 
        RowBox[{
         RowBox[{"Conjugate", "[", 
          SubscriptBox["M", 
           RowBox[{"0", ",", "0"}]], "]"}], " ", 
         SubscriptBox["M", 
          RowBox[{"2", ",", "2"}]]}]}], ")"}]}]}], ")"}]}], 
  RowBox[{"7", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"25", " ", 
      SuperscriptBox[
       RowBox[{"Abs", "[", 
        SubscriptBox["M", 
         RowBox[{"0", ",", "0"}]], "]"}], "2"]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"Abs", "[", 
        SubscriptBox["M", 
         RowBox[{"2", ",", "2"}]], "]"}], "2"]}]}], ")"}]}]]], "Output",
 CellChangeTimes->{{3.903774549160446*^9, 3.903774588795656*^9}, {
   3.903774645508664*^9, 3.903774675354391*^9}, 3.903776902557026*^9, {
   3.903777264484394*^9, 3.903777269289261*^9}, 3.903778334461953*^9, 
   3.9041213525582743`*^9, 3.904121439322186*^9},
 CellLabel->
  "Out[129]=",ExpressionUUID->"be455039-b6e1-433f-99c6-303b49080edd"],

Cell[BoxData[
 FractionBox[
  RowBox[{"36", " ", 
   SuperscriptBox[
    RowBox[{"Abs", "[", 
     SubscriptBox["M", 
      RowBox[{"2", ",", "2"}]], "]"}], "2"]}], 
  RowBox[{
   RowBox[{"175", " ", 
    SuperscriptBox[
     RowBox[{"Abs", "[", 
      SubscriptBox["M", 
       RowBox[{"0", ",", "0"}]], "]"}], "2"]}], "+", 
   RowBox[{"14", " ", 
    SuperscriptBox[
     RowBox[{"Abs", "[", 
      SubscriptBox["M", 
       RowBox[{"2", ",", "2"}]], "]"}], "2"]}]}]]], "Output",
 CellChangeTimes->{{3.903774549160446*^9, 3.903774588795656*^9}, {
   3.903774645508664*^9, 3.903774675354391*^9}, 3.903776902557026*^9, {
   3.903777264484394*^9, 3.903777269289261*^9}, 3.903778334461953*^9, 
   3.9041213525582743`*^9, 3.90412144102018*^9},
 CellLabel->
  "Out[130]=",ExpressionUUID->"b51c8eee-d11d-4b0a-a9da-33e1c14c69ac"]
}, Open  ]],

Cell["In the next cell we do the same thing, but from a p-orbital", "Text",
 CellChangeTimes->{{3.9037782186907806`*^9, 
  3.903778239911236*^9}},ExpressionUUID->"74044162-a43d-441f-bb82-\
fb505ffce502"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"AsymmetryParameter", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", "1", ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"AsymmetryParameter", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "0"}], "}"}], ",", "1", ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"AsymmetryParameter", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"4", ",", "0"}], "}"}], ",", "1", ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.903778250978513*^9, 3.90377825411639*^9}, {
  3.903778324221304*^9, 3.9037783244693017`*^9}},
 CellLabel->
  "In[205]:=",ExpressionUUID->"9236c6e9-ce99-4f19-9786-b7779b8ef818"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "3"], " ", 
   SuperscriptBox[
    RowBox[{"Abs", "[", 
     SubscriptBox["M", 
      RowBox[{"1", ",", "0"}]], "]"}], "2"]}], "+", 
  RowBox[{
   FractionBox["2", "75"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"Abs", "[", 
       SubscriptBox["M", 
        RowBox[{"1", ",", "2"}]], "]"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"Abs", "[", 
       SubscriptBox["M", 
        RowBox[{"3", ",", "2"}]], "]"}], "2"]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.903778255351045*^9, 3.903778325620078*^9},
 CellLabel->
  "Out[205]=",ExpressionUUID->"aaa5de2e-b484-4680-8c15-36754a53c89d"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"14", " ", 
    SuperscriptBox[
     RowBox[{"Abs", "[", 
      SubscriptBox["M", 
       RowBox[{"1", ",", "2"}]], "]"}], "2"]}], "+", 
   RowBox[{"16", " ", 
    SuperscriptBox[
     RowBox[{"Abs", "[", 
      SubscriptBox["M", 
       RowBox[{"3", ",", "2"}]], "]"}], "2"]}], "-", 
   RowBox[{
    SqrtBox["6"], " ", 
    RowBox[{"Conjugate", "[", 
     SubscriptBox["M", 
      RowBox[{"3", ",", "2"}]], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"35", " ", 
       SubscriptBox["M", 
        RowBox[{"1", ",", "0"}]]}], "+", 
      RowBox[{"2", " ", 
       SubscriptBox["M", 
        RowBox[{"1", ",", "2"}]]}]}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"Conjugate", "[", 
     SubscriptBox["M", 
      RowBox[{"1", ",", "2"}]], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"70", " ", 
       SubscriptBox["M", 
        RowBox[{"1", ",", "0"}]]}], "-", 
      RowBox[{"2", " ", 
       SqrtBox["6"], " ", 
       SubscriptBox["M", 
        RowBox[{"3", ",", "2"}]]}]}], ")"}]}], "+", 
   RowBox[{"35", " ", 
    RowBox[{"Conjugate", "[", 
     SubscriptBox["M", 
      RowBox[{"1", ",", "0"}]], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       SubscriptBox["M", 
        RowBox[{"1", ",", "2"}]]}], "-", 
      RowBox[{
       SqrtBox["6"], " ", 
       SubscriptBox["M", 
        RowBox[{"3", ",", "2"}]]}]}], ")"}]}]}], 
  RowBox[{"7", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"25", " ", 
      SuperscriptBox[
       RowBox[{"Abs", "[", 
        SubscriptBox["M", 
         RowBox[{"1", ",", "0"}]], "]"}], "2"]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"Abs", "[", 
          SubscriptBox["M", 
           RowBox[{"1", ",", "2"}]], "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"Abs", "[", 
          SubscriptBox["M", 
           RowBox[{"3", ",", "2"}]], "]"}], "2"]}], ")"}]}]}], 
    ")"}]}]]], "Output",
 CellChangeTimes->{3.903778255351045*^9, 3.9037783282933254`*^9},
 CellLabel->
  "Out[206]=",ExpressionUUID->"2309f35f-a064-49a0-99e0-1b6ae344d4f5"],

Cell[BoxData[
 FractionBox[
  RowBox[{"12", " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"Abs", "[", 
       SubscriptBox["M", 
        RowBox[{"3", ",", "2"}]], "]"}], "2"], "-", 
     RowBox[{
      SqrtBox["6"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Conjugate", "[", 
          SubscriptBox["M", 
           RowBox[{"3", ",", "2"}]], "]"}], " ", 
         SubscriptBox["M", 
          RowBox[{"1", ",", "2"}]]}], "+", 
        RowBox[{
         RowBox[{"Conjugate", "[", 
          SubscriptBox["M", 
           RowBox[{"1", ",", "2"}]], "]"}], " ", 
         SubscriptBox["M", 
          RowBox[{"3", ",", "2"}]]}]}], ")"}]}]}], ")"}]}], 
  RowBox[{"7", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"25", " ", 
      SuperscriptBox[
       RowBox[{"Abs", "[", 
        SubscriptBox["M", 
         RowBox[{"1", ",", "0"}]], "]"}], "2"]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"Abs", "[", 
          SubscriptBox["M", 
           RowBox[{"1", ",", "2"}]], "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"Abs", "[", 
          SubscriptBox["M", 
           RowBox[{"3", ",", "2"}]], "]"}], "2"]}], ")"}]}]}], 
    ")"}]}]]], "Output",
 CellChangeTimes->{3.903778255351045*^9, 3.903778330346841*^9},
 CellLabel->
  "Out[207]=",ExpressionUUID->"5bb90082-bdc1-4a37-b2aa-17c97428b92a"]
}, Open  ]],

Cell[TextData[{
 "In the next cell we compute ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Sigma]", "0"], TraditionalForm]],ExpressionUUID->
  "a2616bc7-7060-419e-bdb2-b7adf3651a72"],
 ", and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Beta]", 
    RowBox[{"l", ",", "m"}]], TraditionalForm]],ExpressionUUID->
  "c067d974-b600-4d82-9c28-7ab43fdf05c7"],
 " with l=2,4 and m=-l to l for an electron from s ionized by right \
circularly polarized light"
}], "Text",
 CellChangeTimes->{{3.9037782674024987`*^9, 3.903778295991374*^9}, {
  3.9037784025282373`*^9, 
  3.9037784334876537`*^9}},ExpressionUUID->"3ec5a823-4280-41b4-9366-\
90520ae73dc3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "@", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"AsymmetryParameter", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"l", ",", "m"}], "}"}], ",", "0", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"l", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "2", ",", "4"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"m", ",", 
      RowBox[{"-", "l"}], ",", "l"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.903778303996199*^9, 3.903778319507354*^9}, {
  3.903778438631366*^9, 3.9037784854725504`*^9}},
 CellLabel->
  "In[213]:=",ExpressionUUID->"bcc965c4-b6d1-4443-a5e2-cc9b8eb13416"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"{", 
        RowBox[{
         FractionBox["1", "150"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"6", " ", 
            SuperscriptBox[
             RowBox[{"Abs", "[", 
              SubscriptBox["M", 
               RowBox[{"\<\"a\"\>", ",", "2", ",", "2"}]], "]"}], "2"]}], "+", 
           RowBox[{"50", " ", 
            SuperscriptBox[
             RowBox[{"Abs", "[", 
              SubscriptBox["M", 
               RowBox[{"\<\"e\"\>", ",", "0", ",", "0"}]], "]"}], "2"]}], "+", 
           SuperscriptBox[
            RowBox[{"Abs", "[", 
             SubscriptBox["M", 
              RowBox[{"\<\"e\"\>", ",", "2", ",", "2"}]], "]"}], "2"]}], 
          ")"}]}], "}"}]},
      {
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"2", " ", 
            SqrtBox["15"], " ", 
            RowBox[{"Conjugate", "[", 
             SubscriptBox["M", 
              RowBox[{"\<\"a\"\>", ",", "2", ",", "2"}]], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "35"}], " ", 
               SubscriptBox["M", 
                RowBox[{"\<\"e\"\>", ",", "0", ",", "0"}]]}], "+", 
              RowBox[{
               SqrtBox["10"], " ", 
               SubscriptBox["M", 
                RowBox[{"\<\"e\"\>", ",", "2", ",", "2"}]]}]}], ")"}]}], 
           RowBox[{"7", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"6", " ", 
               SuperscriptBox[
                RowBox[{"Abs", "[", 
                 SubscriptBox["M", 
                  RowBox[{"\<\"a\"\>", ",", "2", ",", "2"}]], "]"}], "2"]}], 
              "+", 
              RowBox[{"50", " ", 
               SuperscriptBox[
                RowBox[{"Abs", "[", 
                 SubscriptBox["M", 
                  RowBox[{"\<\"e\"\>", ",", "0", ",", "0"}]], "]"}], "2"]}], 
              "+", 
              SuperscriptBox[
               RowBox[{"Abs", "[", 
                SubscriptBox["M", 
                 RowBox[{"\<\"e\"\>", ",", "2", ",", "2"}]], "]"}], "2"]}], 
             ")"}]}]]}], ",", "0", ",", 
         FractionBox[
          RowBox[{"5", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "12"}], " ", 
              SuperscriptBox[
               RowBox[{"Abs", "[", 
                SubscriptBox["M", 
                 RowBox[{"\<\"a\"\>", ",", "2", ",", "2"}]], "]"}], "2"]}], 
             "+", 
             RowBox[{"2", " ", 
              SuperscriptBox[
               RowBox[{"Abs", "[", 
                SubscriptBox["M", 
                 RowBox[{"\<\"e\"\>", ",", "2", ",", "2"}]], "]"}], "2"]}], 
             "+", 
             RowBox[{"7", " ", 
              SqrtBox["10"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Conjugate", "[", 
                  SubscriptBox["M", 
                   RowBox[{"\<\"e\"\>", ",", "2", ",", "2"}]], "]"}], " ", 
                 SubscriptBox["M", 
                  RowBox[{"\<\"e\"\>", ",", "0", ",", "0"}]]}], "+", 
                RowBox[{
                 RowBox[{"Conjugate", "[", 
                  SubscriptBox["M", 
                   RowBox[{"\<\"e\"\>", ",", "0", ",", "0"}]], "]"}], " ", 
                 SubscriptBox["M", 
                  RowBox[{"\<\"e\"\>", ",", "2", ",", "2"}]]}]}], ")"}]}]}], 
            ")"}]}], 
          RowBox[{"7", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"6", " ", 
              SuperscriptBox[
               RowBox[{"Abs", "[", 
                SubscriptBox["M", 
                 RowBox[{"\<\"a\"\>", ",", "2", ",", "2"}]], "]"}], "2"]}], 
             "+", 
             RowBox[{"50", " ", 
              SuperscriptBox[
               RowBox[{"Abs", "[", 
                SubscriptBox["M", 
                 RowBox[{"\<\"e\"\>", ",", "0", ",", "0"}]], "]"}], "2"]}], 
             "+", 
             SuperscriptBox[
              RowBox[{"Abs", "[", 
               SubscriptBox["M", 
                RowBox[{"\<\"e\"\>", ",", "2", ",", "2"}]], "]"}], "2"]}], 
            ")"}]}]], ",", "0", ",", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"2", " ", 
            SqrtBox["15"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "35"}], " ", 
               RowBox[{"Conjugate", "[", 
                SubscriptBox["M", 
                 RowBox[{"\<\"e\"\>", ",", "0", ",", "0"}]], "]"}]}], "+", 
              RowBox[{
               SqrtBox["10"], " ", 
               RowBox[{"Conjugate", "[", 
                SubscriptBox["M", 
                 RowBox[{"\<\"e\"\>", ",", "2", ",", "2"}]], "]"}]}]}], ")"}],
             " ", 
            SubscriptBox["M", 
             RowBox[{"\<\"a\"\>", ",", "2", ",", "2"}]]}], 
           RowBox[{"7", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"6", " ", 
               SuperscriptBox[
                RowBox[{"Abs", "[", 
                 SubscriptBox["M", 
                  RowBox[{"\<\"a\"\>", ",", "2", ",", "2"}]], "]"}], "2"]}], 
              "+", 
              RowBox[{"50", " ", 
               SuperscriptBox[
                RowBox[{"Abs", "[", 
                 SubscriptBox["M", 
                  RowBox[{"\<\"e\"\>", ",", "0", ",", "0"}]], "]"}], "2"]}], 
              "+", 
              SuperscriptBox[
               RowBox[{"Abs", "[", 
                SubscriptBox["M", 
                 RowBox[{"\<\"e\"\>", ",", "2", ",", "2"}]], "]"}], "2"]}], 
             ")"}]}]]}]}], "}"}]},
      {
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         FractionBox[
          RowBox[{"9", " ", 
           SqrtBox["10"], " ", 
           RowBox[{"Conjugate", "[", 
            SubscriptBox["M", 
             RowBox[{"\<\"a\"\>", ",", "2", ",", "2"}]], "]"}], " ", 
           SubscriptBox["M", 
            RowBox[{"\<\"e\"\>", ",", "2", ",", "2"}]]}], 
          RowBox[{"7", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"6", " ", 
              SuperscriptBox[
               RowBox[{"Abs", "[", 
                SubscriptBox["M", 
                 RowBox[{"\<\"a\"\>", ",", "2", ",", "2"}]], "]"}], "2"]}], 
             "+", 
             RowBox[{"50", " ", 
              SuperscriptBox[
               RowBox[{"Abs", "[", 
                SubscriptBox["M", 
                 RowBox[{"\<\"e\"\>", ",", "0", ",", "0"}]], "]"}], "2"]}], 
             "+", 
             SuperscriptBox[
              RowBox[{"Abs", "[", 
               SubscriptBox["M", 
                RowBox[{"\<\"e\"\>", ",", "2", ",", "2"}]], "]"}], "2"]}], 
            ")"}]}]], ",", "0", ",", 
         FractionBox[
          RowBox[{"18", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"Abs", "[", 
               SubscriptBox["M", 
                RowBox[{"\<\"a\"\>", ",", "2", ",", "2"}]], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"Abs", "[", 
               SubscriptBox["M", 
                RowBox[{"\<\"e\"\>", ",", "2", ",", "2"}]], "]"}], "2"]}], 
            ")"}]}], 
          RowBox[{"7", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"6", " ", 
              SuperscriptBox[
               RowBox[{"Abs", "[", 
                SubscriptBox["M", 
                 RowBox[{"\<\"a\"\>", ",", "2", ",", "2"}]], "]"}], "2"]}], 
             "+", 
             RowBox[{"50", " ", 
              SuperscriptBox[
               RowBox[{"Abs", "[", 
                SubscriptBox["M", 
                 RowBox[{"\<\"e\"\>", ",", "0", ",", "0"}]], "]"}], "2"]}], 
             "+", 
             SuperscriptBox[
              RowBox[{"Abs", "[", 
               SubscriptBox["M", 
                RowBox[{"\<\"e\"\>", ",", "2", ",", "2"}]], "]"}], "2"]}], 
            ")"}]}]], ",", "0", ",", 
         FractionBox[
          RowBox[{"9", " ", 
           SqrtBox["10"], " ", 
           RowBox[{"Conjugate", "[", 
            SubscriptBox["M", 
             RowBox[{"\<\"e\"\>", ",", "2", ",", "2"}]], "]"}], " ", 
           SubscriptBox["M", 
            RowBox[{"\<\"a\"\>", ",", "2", ",", "2"}]]}], 
          RowBox[{"7", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"6", " ", 
              SuperscriptBox[
               RowBox[{"Abs", "[", 
                SubscriptBox["M", 
                 RowBox[{"\<\"a\"\>", ",", "2", ",", "2"}]], "]"}], "2"]}], 
             "+", 
             RowBox[{"50", " ", 
              SuperscriptBox[
               RowBox[{"Abs", "[", 
                SubscriptBox["M", 
                 RowBox[{"\<\"e\"\>", ",", "0", ",", "0"}]], "]"}], "2"]}], 
             "+", 
             SuperscriptBox[
              RowBox[{"Abs", "[", 
               SubscriptBox["M", 
                RowBox[{"\<\"e\"\>", ",", "2", ",", "2"}]], "]"}], "2"]}], 
            ")"}]}]], ",", "0", ",", "0"}], "}"}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.903778308099063*^9, 3.903778320069742*^9}, {
  3.9037784678569*^9, 3.903778492201897*^9}},
 CellLabel->
  "Out[213]//MatrixForm=",ExpressionUUID->"16361067-fb4b-4709-9a63-\
a623cd0aa6a9"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Export relativistic asymmetry parameter to file", "Section",
 CellChangeTimes->{{3.876217906372792*^9, 3.8762179145301995`*^9}, {
  3.876218004537495*^9, 
  3.876218006525606*^9}},ExpressionUUID->"33bbead1-6d91-49cb-9866-\
a0767639415e"],

Cell["\<\
The following code can be used to write the coefficients of the asymmetry \
parameters and integrated cross section of a two photon RABBIT process to a \
text file in a well defined format.\
\>", "Text",
 CellChangeTimes->{{3.876217933605172*^9, 3.876217957839299*^9}, {
  3.87621821360248*^9, 3.8762182488990126`*^9}, {3.8762204913158884`*^9, 
  3.876220513563809*^9}},ExpressionUUID->"e018164e-795d-4222-afcb-\
466d29bf1bb3"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{
  "ExportAsymmetryParameter", ",", "\[Kappa]f2", ",", "\[Beta]2\[Gamma]", ",",
    "norm2\[Gamma]", ",", "num2\[Gamma]", ",", "den2\[Gamma]", ",", 
   "\[Kappa]s2\[Gamma]", ",", "Ks", ",", "numcoeffs2\[Gamma]", ",", 
   "dencoeffs2\[Gamma]", ",", "\[Sigma]02\[Gamma]", ",", 
   "\[Sigma]0coeffs2\[Gamma]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExportAsymmetryParameter", "::", "usage"}], "=", 
   "\"\<Exports the coefficients of the given asymmetry parameter to a text \
file. The first argument is the order of the parameter, the second is the \
kappa quantum number of the hole and the third is an optional path to where \
to save the coefficients. Will always report five possible final states, even \
if they are not physically valid. This is intentional, as it allows for a \
consistent matrix size in the output files\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExportAsymmetryParameter", "[", 
    RowBox[{"n_Integer", ",", "\[Kappa]0_Integer", ",", 
     RowBox[{"path_String", ":", "$UserDocumentsDirectory"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Beta]2\[Gamma]", ",", "norm2\[Gamma]", ",", "num2\[Gamma]", ",", 
       "den2\[Gamma]", ",", "\[Kappa]s2\[Gamma]", ",", 
       RowBox[{"Ks", "=", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "2"}], "}"}]}], ",", 
       "numcoeffs2\[Gamma]", ",", "dencoeffs2\[Gamma]", ",", 
       "\[Sigma]02\[Gamma]", ",", "\[Sigma]0coeffs2\[Gamma]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Kappa]s2\[Gamma]", "=", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"m", "=", 
            RowBox[{"Abs", "[", "\[Kappa]0", "]"}]}], ",", 
           RowBox[{"s", "=", 
            RowBox[{"Sign", "[", "\[Kappa]0", "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"s", 
            RowBox[{"(", 
             RowBox[{"m", "-", "2"}], ")"}]}], ",", 
           RowBox[{
            RowBox[{"-", "s"}], 
            RowBox[{"(", 
             RowBox[{"m", "-", "1"}], ")"}]}], ",", 
           RowBox[{"s", " ", "m"}], ",", 
           RowBox[{
            RowBox[{"-", "s"}], 
            RowBox[{"(", 
             RowBox[{"m", "+", "1"}], ")"}]}], ",", 
           RowBox[{"s", 
            RowBox[{"(", 
             RowBox[{"m", "+", "2"}], ")"}]}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"n", "!=", "0"}], ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Computing formula for asymmetry parameter \>\"", ",", 
           SubscriptBox["\[Beta]", "n"], ",", "\"\< from hole \[Kappa]0=\>\"",
            ",", "\[Kappa]0", ",", 
           "\"\< into states with \!\(\*SubscriptBox[\(\[Kappa]\), \
\(f\)]\)=\>\"", ",", "\[Kappa]s2\[Gamma]"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"\[Beta]2\[Gamma]", " ", "=", " ", 
          RowBox[{"RelativisticAsymmetryParameter", "[", 
           RowBox[{"n", ",", "\[Kappa]0"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Got formula: \>\"", ",", "\[Beta]2\[Gamma]"}], "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"norm2\[Gamma]", "=", 
          RowBox[{
           RowBox[{"Denominator", "[", "\[Beta]2\[Gamma]", "]"}], "/.", 
           RowBox[{
            RowBox[{"a_", 
             RowBox[{"(", "b_", ")"}]}], "->", 
            RowBox[{"1", "/", "a"}]}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"num2\[Gamma]", "=", 
          RowBox[{"Expand", "[", 
           RowBox[{"norm2\[Gamma]", " ", 
            RowBox[{"Numerator", "[", "\[Beta]2\[Gamma]", "]"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"den2\[Gamma]", "=", 
          RowBox[{"Expand", "[", 
           RowBox[{"norm2\[Gamma]", " ", 
            RowBox[{"Denominator", "[", "\[Beta]2\[Gamma]", "]"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"numcoeffs2\[Gamma]", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"num2\[Gamma]", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 SubscriptBox["M", 
                  RowBox[{"\[Kappa]11_", ",", "K11_"}]], 
                 RowBox[{"Conjugate", "[", 
                  SubscriptBox["M", 
                   RowBox[{"\[Kappa]22_", ",", "K22_"}]], "]"}]}], 
                "\[RuleDelayed]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Kappa]11", "\[Equal]", "\[Kappa]1"}], "&&", 
                   RowBox[{"\[Kappa]22", "\[Equal]", "\[Kappa]2"}], "&&", 
                   RowBox[{"K11", "\[Equal]", "K1"}], "&&", 
                   RowBox[{"K22", "\[Equal]", "K2"}]}], ",", "1", ",", "0"}], 
                 "]"}]}], ",", 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"Abs", "[", 
                  SubscriptBox["M", 
                   RowBox[{"\[Kappa]11_", ",", "K11_"}]], "]"}], "2"], 
                "\[RuleDelayed]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Kappa]11", "\[Equal]", "\[Kappa]1"}], "&&", 
                   RowBox[{"\[Kappa]11", "\[Equal]", "\[Kappa]2"}], "&&", 
                   RowBox[{"K11", "\[Equal]", "K1"}], "&&", 
                   RowBox[{"K11", "\[Equal]", "K2"}]}], ",", "1", ",", "0"}], 
                 "]"}]}]}], "}"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Kappa]1", ",", "\[Kappa]s2\[Gamma]"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Kappa]2", ",", "\[Kappa]s2\[Gamma]"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"K1", ",", "Ks"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"K2", ",", "Ks"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Coefficients for numerator ((\!\(\*SubscriptBox[\(\[Kappa]\), \
\(f\)]\)*\!\(\*SubscriptBox[\(\[Kappa]\), \(f\)]\)')*(K*K')): \>\"", ",", 
           RowBox[{"MatrixForm", "@", "numcoeffs2\[Gamma]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"dencoeffs2\[Gamma]", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"den2\[Gamma]", "/.", 
             RowBox[{"{", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"Abs", "[", 
                 SubscriptBox["M", 
                  RowBox[{"\[Kappa]_", ",", "K_"}]], "]"}], "2"], 
               "\[RuleDelayed]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Kappa]", "\[Equal]", "kappa"}], "&&", 
                  RowBox[{"K", "\[Equal]", "K\[ARing]"}]}], ",", "1", ",", 
                 "0"}], "]"}]}], "}"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"kappa", ",", "\[Kappa]s2\[Gamma]"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"K\[ARing]", ",", "Ks"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Coefficients for denominator (\!\(\*SubscriptBox[\(\[Kappa]\), \
\(f\)]\)*K): \>\"", ",", 
           RowBox[{"MatrixForm", "@", "dencoeffs2\[Gamma]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Exported to \>\"", ",", 
           RowBox[{"Export", "[", 
            RowBox[{
             RowBox[{
             "path", "<>", "$PathnameSeparator", "<>", 
              "\"\<asymmetry_coeffs_\>\"", "<>", 
              RowBox[{"ToString", "[", "n", "]"}], "<>", "\"\<_\>\"", "<>", 
              RowBox[{"ToString", "[", "\[Kappa]0", "]"}], "<>", 
              "\"\<.txt\>\""}], ",", 
             RowBox[{"\"\<2\\n\>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"Dimensions", "[", "numcoeffs2\[Gamma]", "]"}], "]"}], 
              "<>", "\"\<\\n\>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"Dimensions", "[", "dencoeffs2\[Gamma]", "]"}], "]"}], 
              "<>", "\"\<\\n\>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"N", "[", 
                RowBox[{"numcoeffs2\[Gamma]", ",", "$MachinePrecision"}], 
                "]"}], "]"}], "<>", "\"\<\\n\>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"N", "[", 
                RowBox[{"dencoeffs2\[Gamma]", ",", "$MachinePrecision"}], 
                "]"}], "]"}]}]}], "]"}]}], "]"}], ";"}], 
        "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Calculating integrated signal from hole \[Kappa]0=\>\"", ",", 
           "\[Kappa]0", ",", 
           "\"\< into states with \!\(\*SubscriptBox[\(\[Kappa]\), \
\(f\)]\)=\>\"", ",", "\[Kappa]s2\[Gamma]"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"\[Sigma]02\[Gamma]", "=", 
          RowBox[{"Expand", "[", 
           RowBox[{
            FractionBox["1", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox["\[Zeta]", "2"]}], ")"}]], 
            RowBox[{"RelativisticAsymmetryParameter", "[", 
             RowBox[{"0", ",", "\[Kappa]0"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Got formula: \>\"", ",", "\[Sigma]02\[Gamma]"}], "]"}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"\[Sigma]0coeffs2\[Gamma]", "=", 
          RowBox[{"N", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"\[Sigma]02\[Gamma]", "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"a_", " ", 
                   SuperscriptBox[
                    RowBox[{"Abs", "[", 
                    SubscriptBox["M", 
                    RowBox[{"kappa_", ",", "K\[ARing]_"}]], "]"}], "2"]}], 
                  "\[RuleDelayed]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"kappa", "\[Equal]", "\[Kappa]"}], "&&", 
                    RowBox[{"K\[ARing]", "\[Equal]", "K"}]}], ",", "a", ",", 
                    "0"}], "]"}]}], ",", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"Abs", "[", 
                    SubscriptBox["M", 
                    RowBox[{"kappa_", ",", "K\[ARing]_"}]], "]"}], "2"], 
                  "\[RuleDelayed]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"kappa", "\[Equal]", "\[Kappa]"}], "&&", 
                    RowBox[{"K\[ARing]", "\[Equal]", "K"}]}], ",", "1", ",", 
                    "0"}], "]"}]}]}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Kappa]", ",", "\[Kappa]s2\[Gamma]"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"K", ",", "Ks"}], "}"}]}], "]"}], ",", 
            "$MachinePrecision"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Coefficients for integrated signal: \>\"", ",", 
           RowBox[{"MatrixForm", "@", "\[Sigma]0coeffs2\[Gamma]"}]}], "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Exported to \>\"", ",", 
           RowBox[{"Export", "[", 
            RowBox[{
             RowBox[{
             "path", "<>", "$PathnameSeparator", "<>", 
              "\"\<integrated_intensity_\>\"", "<>", 
              RowBox[{"ToString", "[", "\[Kappa]0", "]"}], "<>", 
              "\"\<.txt\>\""}], ",", 
             RowBox[{"\"\<1\\n\>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"Dimensions", "[", "\[Sigma]0coeffs2\[Gamma]", "]"}], 
               "]"}], "<>", "\"\<\\n\>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"N", "[", 
                RowBox[{
                "\[Sigma]0coeffs2\[Gamma]", ",", "$MachinePrecision"}], "]"}],
                "]"}]}]}], "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8762179617560186`*^9, 3.876218209429101*^9}, {
   3.8762182615572677`*^9, 3.8762183025072937`*^9}, {3.876218334492788*^9, 
   3.876218489766366*^9}, {3.8762185289118605`*^9, 3.876218643298435*^9}, {
   3.876218681679621*^9, 3.8762187237031026`*^9}, {3.876218762121384*^9, 
   3.8762191810235286`*^9}, {3.876219223500017*^9, 3.876219254113228*^9}, {
   3.876219334514322*^9, 3.876219392117101*^9}, {3.8762195663744187`*^9, 
   3.876219596604536*^9}, {3.8762196492109623`*^9, 3.8762196586732836`*^9}, {
   3.876219699354488*^9, 3.8762197206274157`*^9}, {3.876219775763563*^9, 
   3.876219809276503*^9}, {3.876219912921529*^9, 3.876219960058606*^9}, {
   3.876220045616108*^9, 3.8762200710799413`*^9}, {3.876220148792651*^9, 
   3.876220267777456*^9}, {3.876220305048973*^9, 3.876220306588087*^9}, {
   3.8762203386909027`*^9, 3.876220404366461*^9}, {3.876220603955991*^9, 
   3.8762206400787573`*^9}, {3.876220673779997*^9, 3.876220701232918*^9}, {
   3.876220732101882*^9, 3.876220766377977*^9}, {3.876220964057722*^9, 
   3.876220965966768*^9}, {3.876221028476446*^9, 3.876221038460963*^9}, {
   3.8762212170756426`*^9, 3.876221238611264*^9}, {3.8762213105748663`*^9, 
   3.8762213149795537`*^9}, {3.8762213665729876`*^9, 3.8762213673401227`*^9}, 
   3.9088674393182106`*^9},
 CellLabel->"In[61]:=",ExpressionUUID->"de63f07f-61e6-42ec-9523-4bca26f92f11"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Examples", "Section",
 CellChangeTimes->{{3.904726209844298*^9, 
  3.904726222070396*^9}},ExpressionUUID->"0394d784-045d-468b-8bdb-\
10594d0cc071"],

Cell["\<\
Contrast which terms contribute to which asymmetry parameters in the two \
examples below. The first example has only linearly polarized light and the \
second example has a circularly polarized IR-photon (unfortunately in a \
crossed beams geometry).\
\>", "Text",
 CellChangeTimes->{{3.904726228421045*^9, 3.904726275636807*^9}, {
  3.9047263604965086`*^9, 
  3.904726369577091*^9}},ExpressionUUID->"44f66894-dcdf-4cc3-82f8-\
84bd4398df42"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Print", "[", "\"\<Diagonal term contribution\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<To \!\(\*SubscriptBox[\(\[Beta]\), \(40\)]\)\>\"",
   "]"}], "\[IndentingNewLine]", 
 RowBox[{"AsymmetryParameter", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"4", ",", "0"}], "}"}], ",", "1", ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"Terms", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<aa\>\"", ",", "\"\<ee\>\""}], "}"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<To \!\(\*SubscriptBox[\(\[Beta]\), \(42\)]\)\>\"",
   "]"}], "\[IndentingNewLine]", 
 RowBox[{"AsymmetryParameter", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"4", ",", "2"}], "}"}], ",", "1", ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"Terms", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<aa\>\"", ",", "\"\<ee\>\""}], "}"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Cross term contribution\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<To \!\(\*SubscriptBox[\(\[Beta]\), \(40\)]\)\>\"",
   "]"}], "\[IndentingNewLine]", 
 RowBox[{"AsymmetryParameter", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"4", ",", "0"}], "}"}], ",", "1", ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"Terms", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<ea\>\"", ",", "\"\<ae\>\""}], "}"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<To \!\(\*SubscriptBox[\(\[Beta]\), \(42\)]\)\>\"",
   "]"}], "\[IndentingNewLine]", 
 RowBox[{"AsymmetryParameter", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"4", ",", "2"}], "}"}], ",", "1", ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"Terms", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<ea\>\"", ",", "\"\<ae\>\""}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.9047258813447857`*^9, 3.904725921285946*^9}, {
  3.904726161947975*^9, 3.9047261691196065`*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"4866bc47-cd6e-46f1-ba11-bbf089e1a1fd"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Diagonal term contribution\"\>"], "Print",
 CellChangeTimes->{3.904726169414321*^9, 3.9047923069248176`*^9},
 CellLabel->
  "During evaluation of \
In[22]:=",ExpressionUUID->"48e0af3c-cd0d-490c-ae57-12c919b9277f"],

Cell[BoxData["\<\"To \\!\\(\\*SubscriptBox[\\(\[Beta]\\), \\(40\\)]\\)\"\>"], \
"Print",
 CellChangeTimes->{3.904726169414321*^9, 3.904792306937775*^9},
 CellLabel->
  "During evaluation of \
In[22]:=",ExpressionUUID->"1205b617-06e8-45bd-a6fb-ebdd40312401"]
}, Open  ]],

Cell[BoxData[
 FractionBox[
  RowBox[{"12", " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"Abs", "[", 
       SubscriptBox["M", 
        RowBox[{"\<\"a\"\>", ",", "3", ",", "2"}]], "]"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"Abs", "[", 
       SubscriptBox["M", 
        RowBox[{"\<\"e\"\>", ",", "3", ",", "2"}]], "]"}], "2"], "-", 
     RowBox[{
      SqrtBox["6"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Conjugate", "[", 
          SubscriptBox["M", 
           RowBox[{"\<\"a\"\>", ",", "3", ",", "2"}]], "]"}], " ", 
         SubscriptBox["M", 
          RowBox[{"\<\"a\"\>", ",", "1", ",", "2"}]]}], "+", 
        RowBox[{
         RowBox[{"Conjugate", "[", 
          SubscriptBox["M", 
           RowBox[{"\<\"a\"\>", ",", "1", ",", "2"}]], "]"}], " ", 
         SubscriptBox["M", 
          RowBox[{"\<\"a\"\>", ",", "3", ",", "2"}]]}], "+", 
        RowBox[{
         RowBox[{"Conjugate", "[", 
          SubscriptBox["M", 
           RowBox[{"\<\"e\"\>", ",", "3", ",", "2"}]], "]"}], " ", 
         SubscriptBox["M", 
          RowBox[{"\<\"e\"\>", ",", "1", ",", "2"}]]}], "+", 
        RowBox[{
         RowBox[{"Conjugate", "[", 
          SubscriptBox["M", 
           RowBox[{"\<\"e\"\>", ",", "1", ",", "2"}]], "]"}], " ", 
         SubscriptBox["M", 
          RowBox[{"\<\"e\"\>", ",", "3", ",", "2"}]]}]}], ")"}]}]}], ")"}]}], 
  RowBox[{"7", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"25", " ", 
      SuperscriptBox[
       RowBox[{"Abs", "[", 
        SubscriptBox["M", 
         RowBox[{"\<\"a\"\>", ",", "1", ",", "0"}]], "]"}], "2"]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"Abs", "[", 
        SubscriptBox["M", 
         RowBox[{"\<\"a\"\>", ",", "1", ",", "2"}]], "]"}], "2"]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"Abs", "[", 
        SubscriptBox["M", 
         RowBox[{"\<\"a\"\>", ",", "3", ",", "2"}]], "]"}], "2"]}], "+", 
     RowBox[{"25", " ", 
      SuperscriptBox[
       RowBox[{"Abs", "[", 
        SubscriptBox["M", 
         RowBox[{"\<\"e\"\>", ",", "1", ",", "0"}]], "]"}], "2"]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"Abs", "[", 
          SubscriptBox["M", 
           RowBox[{"\<\"e\"\>", ",", "1", ",", "2"}]], "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"Abs", "[", 
          SubscriptBox["M", 
           RowBox[{"\<\"e\"\>", ",", "3", ",", "2"}]], "]"}], "2"]}], 
       ")"}]}]}], ")"}]}]]], "Output",
 CellChangeTimes->{{3.9047258861125937`*^9, 3.904725925266337*^9}, 
   3.904726173461496*^9, 3.904792310859285*^9},
 CellLabel->"Out[24]=",ExpressionUUID->"ad49dbf7-6361-402f-b303-1d0b99be004f"],

Cell[BoxData["\<\"To \\!\\(\\*SubscriptBox[\\(\[Beta]\\), \\(42\\)]\\)\"\>"], \
"Print",
 CellChangeTimes->{3.904726169414321*^9, 3.9047923108722506`*^9},
 CellLabel->
  "During evaluation of \
In[22]:=",ExpressionUUID->"4a936a76-76c4-4935-928b-60b6f4fc62de"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.9047258861125937`*^9, 3.904725925266337*^9}, 
   3.904726173461496*^9, 3.904792313678746*^9},
 CellLabel->"Out[26]=",ExpressionUUID->"e079947d-4327-421a-8e20-18a851f64bb5"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Cross term contribution\"\>"], "Print",
 CellChangeTimes->{3.904726169414321*^9, 3.904792313699701*^9},
 CellLabel->
  "During evaluation of \
In[22]:=",ExpressionUUID->"e0e03051-5605-444a-a997-675c8f609eb1"],

Cell[BoxData["\<\"To \\!\\(\\*SubscriptBox[\\(\[Beta]\\), \\(40\\)]\\)\"\>"], \
"Print",
 CellChangeTimes->{3.904726169414321*^9, 3.904792313708666*^9},
 CellLabel->
  "During evaluation of \
In[22]:=",ExpressionUUID->"bdbcba1b-7c23-464f-a792-bcb0e67a35e1"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"12", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Conjugate", "[", 
        SubscriptBox["M", 
         RowBox[{"\<\"e\"\>", ",", "3", ",", "2"}]], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SqrtBox["6"], " ", 
          SubscriptBox["M", 
           RowBox[{"\<\"a\"\>", ",", "1", ",", "2"}]]}], "-", 
         SubscriptBox["M", 
          RowBox[{"\<\"a\"\>", ",", "3", ",", "2"}]]}], ")"}]}], "+", 
      RowBox[{
       SqrtBox["6"], " ", 
       RowBox[{"Conjugate", "[", 
        SubscriptBox["M", 
         RowBox[{"\<\"e\"\>", ",", "1", ",", "2"}]], "]"}], " ", 
       SubscriptBox["M", 
        RowBox[{"\<\"a\"\>", ",", "3", ",", "2"}]]}], "+", 
      RowBox[{
       RowBox[{"Conjugate", "[", 
        SubscriptBox["M", 
         RowBox[{"\<\"a\"\>", ",", "3", ",", "2"}]], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SqrtBox["6"], " ", 
          SubscriptBox["M", 
           RowBox[{"\<\"e\"\>", ",", "1", ",", "2"}]]}], "-", 
         SubscriptBox["M", 
          RowBox[{"\<\"e\"\>", ",", "3", ",", "2"}]]}], ")"}]}], "+", 
      RowBox[{
       SqrtBox["6"], " ", 
       RowBox[{"Conjugate", "[", 
        SubscriptBox["M", 
         RowBox[{"\<\"a\"\>", ",", "1", ",", "2"}]], "]"}], " ", 
       SubscriptBox["M", 
        RowBox[{"\<\"e\"\>", ",", "3", ",", "2"}]]}]}], ")"}]}], 
   RowBox[{"7", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"25", " ", 
       RowBox[{"Conjugate", "[", 
        SubscriptBox["M", 
         RowBox[{"\<\"e\"\>", ",", "1", ",", "0"}]], "]"}], " ", 
       SubscriptBox["M", 
        RowBox[{"\<\"a\"\>", ",", "1", ",", "0"}]]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"Conjugate", "[", 
        SubscriptBox["M", 
         RowBox[{"\<\"e\"\>", ",", "1", ",", "2"}]], "]"}], " ", 
       SubscriptBox["M", 
        RowBox[{"\<\"a\"\>", ",", "1", ",", "2"}]]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"Conjugate", "[", 
        SubscriptBox["M", 
         RowBox[{"\<\"e\"\>", ",", "3", ",", "2"}]], "]"}], " ", 
       SubscriptBox["M", 
        RowBox[{"\<\"a\"\>", ",", "3", ",", "2"}]]}], "+", 
      RowBox[{"25", " ", 
       RowBox[{"Conjugate", "[", 
        SubscriptBox["M", 
         RowBox[{"\<\"a\"\>", ",", "1", ",", "0"}]], "]"}], " ", 
       SubscriptBox["M", 
        RowBox[{"\<\"e\"\>", ",", "1", ",", "0"}]]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"Conjugate", "[", 
        SubscriptBox["M", 
         RowBox[{"\<\"a\"\>", ",", "1", ",", "2"}]], "]"}], " ", 
       SubscriptBox["M", 
        RowBox[{"\<\"e\"\>", ",", "1", ",", "2"}]]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"Conjugate", "[", 
        SubscriptBox["M", 
         RowBox[{"\<\"a\"\>", ",", "3", ",", "2"}]], "]"}], " ", 
       SubscriptBox["M", 
        RowBox[{"\<\"e\"\>", ",", "3", ",", "2"}]]}]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{{3.9047258861125937`*^9, 3.904725925266337*^9}, 
   3.904726173461496*^9, 3.904792317283016*^9},
 CellLabel->"Out[29]=",ExpressionUUID->"0b9a860e-2280-418a-9c92-5a6c9e6e638f"],

Cell[BoxData["\<\"To \\!\\(\\*SubscriptBox[\\(\[Beta]\\), \\(42\\)]\\)\"\>"], \
"Print",
 CellChangeTimes->{3.904726169414321*^9, 3.9047923172989945`*^9},
 CellLabel->
  "During evaluation of \
In[22]:=",ExpressionUUID->"1b65f831-399c-471c-9656-c3c70a7462b3"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.9047258861125937`*^9, 3.904725925266337*^9}, 
   3.904726173461496*^9, 3.904792319877218*^9},
 CellLabel->"Out[31]=",ExpressionUUID->"3bc5568e-0d18-4c13-8cd4-a9133c560649"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Print", "[", 
  "\"\<Change the IR-photon to be circulary polarized and now:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Diagonal term contribution\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<To \!\(\*SubscriptBox[\(\[Beta]\), \(40\)]\)\>\"",
   "]"}], "\[IndentingNewLine]", 
 RowBox[{"AsymmetryParameter", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"4", ",", "0"}], "}"}], ",", "1", ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}], ",", 
   RowBox[{"Terms", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<aa\>\"", ",", "\"\<ee\>\""}], "}"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<To \!\(\*SubscriptBox[\(\[Beta]\), \(42\)]\)\>\"",
   "]"}], "\[IndentingNewLine]", 
 RowBox[{"AsymmetryParameter", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"4", ",", "2"}], "}"}], ",", "1", ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}], ",", 
   RowBox[{"Terms", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<aa\>\"", ",", "\"\<ee\>\""}], "}"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Cross term contribution\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<To \!\(\*SubscriptBox[\(\[Beta]\), \(40\)]\)\>\"",
   "]"}], "\[IndentingNewLine]", 
 RowBox[{"AsymmetryParameter", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"4", ",", "0"}], "}"}], ",", "1", ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}], ",", 
   RowBox[{"Terms", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<ea\>\"", ",", "\"\<ae\>\""}], "}"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<To \!\(\*SubscriptBox[\(\[Beta]\), \(42\)]\)\>\"",
   "]"}], "\[IndentingNewLine]", 
 RowBox[{"AsymmetryParameter", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"4", ",", "2"}], "}"}], ",", "1", ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}], ",", 
   RowBox[{"Terms", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<ea\>\"", ",", "\"\<ae\>\""}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.904710187113738*^9, 3.90471020042436*^9}, {
  3.9047235552329717`*^9, 3.90472355711441*^9}, {3.9047247374625616`*^9, 
  3.904724766829483*^9}, {3.904725833638172*^9, 3.904725867102972*^9}, {
  3.904725931462038*^9, 3.904725934204854*^9}, {3.904726022661436*^9, 
  3.9047261218012376`*^9}, {3.904726476148575*^9, 3.904726488862022*^9}, {
  3.904793116642314*^9, 3.904793118695158*^9}, {3.904794845814703*^9, 
  3.904794878397283*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"f63053c5-359d-4fd4-8104-fe18ef926b12"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Change the IR-photon to be circulary polarized and \
now:\"\>"], "Print",
 CellChangeTimes->{{3.90472610311296*^9, 3.9047261221851716`*^9}, 
   3.904726489890871*^9, 3.904792319986926*^9, 3.9047931361000824`*^9, {
   3.904794847343594*^9, 3.9047948786319447`*^9}},
 CellLabel->
  "During evaluation of \
In[94]:=",ExpressionUUID->"f1a3692f-f1ff-4014-b85b-2e9d1e8c49a8"],

Cell[BoxData["\<\"Diagonal term contribution\"\>"], "Print",
 CellChangeTimes->{{3.90472610311296*^9, 3.9047261221851716`*^9}, 
   3.904726489890871*^9, 3.904792319986926*^9, 3.9047931361000824`*^9, {
   3.904794847343594*^9, 3.904794878645656*^9}},
 CellLabel->
  "During evaluation of \
In[94]:=",ExpressionUUID->"5f0d0b00-be67-4700-b760-0cb082c88993"],

Cell[BoxData["\<\"To \\!\\(\\*SubscriptBox[\\(\[Beta]\\), \\(40\\)]\\)\"\>"], \
"Print",
 CellChangeTimes->{{3.90472610311296*^9, 3.9047261221851716`*^9}, 
   3.904726489890871*^9, 3.904792319986926*^9, 3.9047931361000824`*^9, {
   3.904794847343594*^9, 3.904794878658869*^9}},
 CellLabel->
  "During evaluation of \
In[94]:=",ExpressionUUID->"6479f6b7-8f57-41e7-a4d6-22c000ef2ea5"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"36", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"Abs", "[", 
        SubscriptBox["M", 
         RowBox[{"\<\"a\"\>", ",", "3", ",", "2"}]], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"Abs", "[", 
        SubscriptBox["M", 
         RowBox[{"\<\"e\"\>", ",", "3", ",", "2"}]], "]"}], "2"], "-", 
      RowBox[{
       SqrtBox["6"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Conjugate", "[", 
           SubscriptBox["M", 
            RowBox[{"\<\"a\"\>", ",", "3", ",", "2"}]], "]"}], " ", 
          SubscriptBox["M", 
           RowBox[{"\<\"a\"\>", ",", "1", ",", "2"}]]}], "+", 
         RowBox[{
          RowBox[{"Conjugate", "[", 
           SubscriptBox["M", 
            RowBox[{"\<\"a\"\>", ",", "1", ",", "2"}]], "]"}], " ", 
          SubscriptBox["M", 
           RowBox[{"\<\"a\"\>", ",", "3", ",", "2"}]]}], "+", 
         RowBox[{
          RowBox[{"Conjugate", "[", 
           SubscriptBox["M", 
            RowBox[{"\<\"e\"\>", ",", "3", ",", "2"}]], "]"}], " ", 
          SubscriptBox["M", 
           RowBox[{"\<\"e\"\>", ",", "1", ",", "2"}]]}], "+", 
         RowBox[{
          RowBox[{"Conjugate", "[", 
           SubscriptBox["M", 
            RowBox[{"\<\"e\"\>", ",", "1", ",", "2"}]], "]"}], " ", 
          SubscriptBox["M", 
           RowBox[{"\<\"e\"\>", ",", "3", ",", "2"}]]}]}], ")"}]}]}], ")"}]}], 
   RowBox[{"7", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"25", " ", 
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         SubscriptBox["M", 
          RowBox[{"\<\"a\"\>", ",", "1", ",", "1"}]], "]"}], "2"]}], "+", 
      RowBox[{"9", " ", 
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         SubscriptBox["M", 
          RowBox[{"\<\"a\"\>", ",", "1", ",", "2"}]], "]"}], "2"]}], "+", 
      RowBox[{"9", " ", 
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         SubscriptBox["M", 
          RowBox[{"\<\"a\"\>", ",", "3", ",", "2"}]], "]"}], "2"]}], "+", 
      RowBox[{"25", " ", 
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         SubscriptBox["M", 
          RowBox[{"\<\"e\"\>", ",", "1", ",", "1"}]], "]"}], "2"]}], "+", 
      RowBox[{"9", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"Abs", "[", 
           SubscriptBox["M", 
            RowBox[{"\<\"e\"\>", ",", "1", ",", "2"}]], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"Abs", "[", 
           SubscriptBox["M", 
            RowBox[{"\<\"e\"\>", ",", "3", ",", "2"}]], "]"}], "2"]}], 
        ")"}]}]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{{3.9047101972800465`*^9, 3.904710206206461*^9}, 
   3.904723560916731*^9, {3.9047247443167*^9, 3.90472477063497*^9}, {
   3.904725843557491*^9, 3.904725870220639*^9}, 3.904725937419997*^9, 
   3.904726038781396*^9, {3.904726107382867*^9, 3.9047261268403015`*^9}, 
   3.9047264940712376`*^9, 3.9047923233289924`*^9, 3.9047931400171432`*^9, {
   3.904794851439597*^9, 3.904794882652048*^9}},
 CellLabel->"Out[97]=",ExpressionUUID->"5312d412-3d72-4a01-8b27-3ccdbf194783"],

Cell[BoxData["\<\"To \\!\\(\\*SubscriptBox[\\(\[Beta]\\), \\(42\\)]\\)\"\>"], \
"Print",
 CellChangeTimes->{{3.90472610311296*^9, 3.9047261221851716`*^9}, 
   3.904726489890871*^9, 3.904792319986926*^9, 3.9047931361000824`*^9, {
   3.904794847343594*^9, 3.904794882668715*^9}},
 CellLabel->
  "During evaluation of \
In[94]:=",ExpressionUUID->"4e3fe0a1-83ea-4a1f-9dcb-366657001871"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.9047101972800465`*^9, 3.904710206206461*^9}, 
   3.904723560916731*^9, {3.9047247443167*^9, 3.90472477063497*^9}, {
   3.904725843557491*^9, 3.904725870220639*^9}, 3.904725937419997*^9, 
   3.904726038781396*^9, {3.904726107382867*^9, 3.9047261268403015`*^9}, 
   3.9047264940712376`*^9, 3.9047923233289924`*^9, 3.9047931400171432`*^9, {
   3.904794851439597*^9, 3.904794885558391*^9}},
 CellLabel->"Out[99]=",ExpressionUUID->"4b6d91e3-a371-4280-88d4-0eed17db6e44"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Cross term contribution\"\>"], "Print",
 CellChangeTimes->{{3.90472610311296*^9, 3.9047261221851716`*^9}, 
   3.904726489890871*^9, 3.904792319986926*^9, 3.9047931361000824`*^9, {
   3.904794847343594*^9, 3.90479488556239*^9}},
 CellLabel->
  "During evaluation of \
In[94]:=",ExpressionUUID->"3a963d8e-8f6f-431f-88d2-20ca7b898ed5"],

Cell[BoxData["\<\"To \\!\\(\\*SubscriptBox[\\(\[Beta]\\), \\(40\\)]\\)\"\>"], \
"Print",
 CellChangeTimes->{{3.90472610311296*^9, 3.9047261221851716`*^9}, 
   3.904726489890871*^9, 3.904792319986926*^9, 3.9047931361000824`*^9, {
   3.904794847343594*^9, 3.904794885568392*^9}},
 CellLabel->
  "During evaluation of \
In[94]:=",ExpressionUUID->"f00cf712-4dfc-4c90-9aa8-954a5691e887"]
}, Open  ]],

Cell[BoxData["Indeterminate"], "Output",
 CellChangeTimes->{{3.9047101972800465`*^9, 3.904710206206461*^9}, 
   3.904723560916731*^9, {3.9047247443167*^9, 3.90472477063497*^9}, {
   3.904725843557491*^9, 3.904725870220639*^9}, 3.904725937419997*^9, 
   3.904726038781396*^9, {3.904726107382867*^9, 3.9047261268403015`*^9}, 
   3.9047264940712376`*^9, 3.9047923233289924`*^9, 3.9047931400171432`*^9, {
   3.904794851439597*^9, 3.904794887907209*^9}},
 CellLabel->
  "Out[102]=",ExpressionUUID->"08dc9056-c9e2-4f16-8b3a-13ea2614201f"],

Cell[BoxData["\<\"To \\!\\(\\*SubscriptBox[\\(\[Beta]\\), \\(42\\)]\\)\"\>"], \
"Print",
 CellChangeTimes->{{3.90472610311296*^9, 3.9047261221851716`*^9}, 
   3.904726489890871*^9, 3.904792319986926*^9, 3.9047931361000824`*^9, {
   3.904794847343594*^9, 3.9047948879426136`*^9}},
 CellLabel->
  "During evaluation of \
In[94]:=",ExpressionUUID->"54b7091a-327a-43fe-9822-da06031e8131"],

Cell[BoxData["ComplexInfinity"], "Output",
 CellChangeTimes->{{3.9047101972800465`*^9, 3.904710206206461*^9}, 
   3.904723560916731*^9, {3.9047247443167*^9, 3.90472477063497*^9}, {
   3.904725843557491*^9, 3.904725870220639*^9}, 3.904725937419997*^9, 
   3.904726038781396*^9, {3.904726107382867*^9, 3.9047261268403015`*^9}, 
   3.9047264940712376`*^9, 3.9047923233289924`*^9, 3.9047931400171432`*^9, {
   3.904794851439597*^9, 3.9047948909667816`*^9}},
 CellLabel->
  "Out[104]=",ExpressionUUID->"c3a7f145-c70d-452f-80b2-b90ea44ffb02"]
}, Open  ]],

Cell["\<\
The contribution from the cross terms (and thus the modulation of the side \
band) moves to the \[Phi] dependent part of the signal!\
\>", "Text",
 CellChangeTimes->{{3.904726280545347*^9, 
  3.904726344486549*^9}},ExpressionUUID->"893e8715-511f-4340-9a78-\
85833e3ae934"]
}, Open  ]]
},
WindowSize->{1141.2, 574.8},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>0.9 Inherited,
FrontEndVersion->"14.0 for Microsoft Windows (64-bit) (December 12, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"71f01b72-9872-4a52-9cf6-5d85ffa26fe1"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 155, 3, 59, "Section",ExpressionUUID->"619a4e76-f68e-40da-a0f6-f3c8486f3cc3"],
Cell[738, 27, 4478, 126, 204, "Text",ExpressionUUID->"00ccf6c8-cf0c-4137-b148-fef25c451da8"],
Cell[5219, 155, 3238, 97, 155, "Text",ExpressionUUID->"74620cda-7603-47ed-a416-9b8b15e1c3d1"],
Cell[8460, 254, 7964, 239, 229, "Text",ExpressionUUID->"2973d668-cee1-4625-8528-230b3fcc7229"],
Cell[16427, 495, 3369, 101, 193, "Text",ExpressionUUID->"36b43be4-4739-4ff4-a46b-db5c0409f318"],
Cell[19799, 598, 14089, 388, 302, "Text",ExpressionUUID->"5ea61c3f-ecbc-43fc-916b-7b734d6fdbb0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33925, 991, 217, 4, 59, "Section",ExpressionUUID->"57efb09f-efdb-4f37-b484-ad434e3bde34"],
Cell[34145, 997, 230, 5, 31, "Text",ExpressionUUID->"2be18b71-54e8-484e-afa5-fd17148a3168"],
Cell[34378, 1004, 9229, 241, 554, "Input",ExpressionUUID->"1b51d95f-1b9f-463e-8dc8-c446fb139799"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43644, 1250, 175, 3, 59, "Section",ExpressionUUID->"96d938b5-2331-42bc-82a9-918d3fc193a9"],
Cell[43822, 1255, 249, 6, 31, "Text",ExpressionUUID->"c5314769-e6c9-420a-8992-de4486e2b1a7"],
Cell[44074, 1263, 22801, 462, 1015, "Input",ExpressionUUID->"d2242f51-2ffa-4e6d-ba67-b3d6bcdf677c"],
Cell[66878, 1727, 687, 17, 31, "Text",ExpressionUUID->"58c02ceb-592a-41cd-bb05-da839b0547a5"],
Cell[CellGroupData[{
Cell[67590, 1748, 647, 16, 79, "Input",ExpressionUUID->"b94cb76b-bed3-4353-a6c4-4445e5e79e6e"],
Cell[68240, 1766, 687, 21, 44, "Output",ExpressionUUID->"f1a7bd77-b0a6-49d2-9b82-473894f64354"],
Cell[68930, 1789, 2559, 85, 71, "Output",ExpressionUUID->"8bcc8f7d-aba6-46a8-ac03-a3d3856122af"],
Cell[71492, 1876, 1461, 47, 54, "Output",ExpressionUUID->"6a0f81f6-cb1a-49cd-af80-33dcc9c42d3e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[73002, 1929, 189, 2, 59, "Section",ExpressionUUID->"3060e96d-43dd-4a0d-b603-e3ee95521454"],
Cell[73194, 1933, 446, 9, 52, "Text",ExpressionUUID->"cf72bc2f-a5e0-4c2e-bbc7-5a6137909ed5"],
Cell[73643, 1944, 32544, 706, 1422, "Input",ExpressionUUID->"b4f86bd9-8ab6-4646-b512-03abc1eb8506"],
Cell[106190, 2652, 812, 24, 32, "Text",ExpressionUUID->"8e7d231b-d47b-40b6-82a3-ceba24ace8ba"],
Cell[CellGroupData[{
Cell[107027, 2680, 934, 24, 60, "Input",ExpressionUUID->"d3c789fb-bd8c-4f7e-a0be-725d349a7957"],
Cell[107964, 2706, 702, 19, 44, "Output",ExpressionUUID->"05d172c4-1b6d-46f8-8abd-501c0f8892cf"],
Cell[108669, 2727, 1473, 44, 54, "Output",ExpressionUUID->"be455039-b6e1-433f-99c6-303b49080edd"],
Cell[110145, 2773, 823, 23, 51, "Output",ExpressionUUID->"b51c8eee-d11d-4b0a-a9da-33e1c14c69ac"]
}, Open  ]],
Cell[110983, 2799, 203, 3, 31, "Text",ExpressionUUID->"74044162-a43d-441f-bb82-fb505ffce502"],
Cell[CellGroupData[{
Cell[111211, 2806, 809, 22, 60, "Input",ExpressionUUID->"9236c6e9-ce99-4f19-9786-b7779b8ef818"],
Cell[112023, 2830, 680, 22, 44, "Output",ExpressionUUID->"aaa5de2e-b484-4680-8c15-36754a53c89d"],
Cell[112706, 2854, 2164, 74, 54, "Output",ExpressionUUID->"2309f35f-a064-49a0-99e0-1b6ae344d4f5"],
Cell[114873, 2930, 1434, 47, 54, "Output",ExpressionUUID->"5bb90082-bdc1-4a37-b2aa-17c97428b92a"]
}, Open  ]],
Cell[116322, 2980, 650, 18, 32, "Text",ExpressionUUID->"3ec5a823-4280-41b4-9366-90520ae73dc3"],
Cell[CellGroupData[{
Cell[116997, 3002, 716, 20, 25, "Input",ExpressionUUID->"bcc965c4-b6d1-4443-a5e2-cc9b8eb13416"],
Cell[117716, 3024, 9815, 266, 112, "Output",ExpressionUUID->"16361067-fb4b-4709-9a63-a623cd0aa6a9"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[127580, 3296, 243, 4, 59, "Section",ExpressionUUID->"33bbead1-6d91-49cb-9866-a0767639415e"],
Cell[127826, 3302, 437, 8, 31, "Text",ExpressionUUID->"e018164e-795d-4222-afcb-466d29bf1bb3"],
Cell[128266, 3312, 14005, 304, 674, "Input",ExpressionUUID->"de63f07f-61e6-42ec-9523-4bca26f92f11"]
}, Open  ]],
Cell[CellGroupData[{
Cell[142308, 3621, 153, 3, 59, "Section",ExpressionUUID->"0394d784-045d-468b-8bdb-10594d0cc071"],
Cell[142464, 3626, 452, 9, 52, "Text",ExpressionUUID->"44f66894-dcdf-4cc3-82f8-84bd4398df42"],
Cell[CellGroupData[{
Cell[142941, 3639, 2091, 54, 180, "Input",ExpressionUUID->"4866bc47-cd6e-46f1-ba11-bbf089e1a1fd"],
Cell[CellGroupData[{
Cell[145057, 3697, 231, 4, 19, "Print",ExpressionUUID->"48e0af3c-cd0d-490c-ae57-12c919b9277f"],
Cell[145291, 3703, 257, 5, 19, "Print",ExpressionUUID->"1205b617-06e8-45bd-a6fb-ebdd40312401"]
}, Open  ]],
Cell[145563, 3711, 2780, 78, 54, "Output",ExpressionUUID->"ad49dbf7-6361-402f-b303-1d0b99be004f"],
Cell[148346, 3791, 259, 5, 19, "Print",ExpressionUUID->"4a936a76-76c4-4935-928b-60b6f4fc62de"],
Cell[148608, 3798, 223, 3, 28, "Output",ExpressionUUID->"e079947d-4327-421a-8e20-18a851f64bb5"],
Cell[CellGroupData[{
Cell[148856, 3805, 226, 4, 19, "Print",ExpressionUUID->"e0e03051-5605-444a-a997-675c8f609eb1"],
Cell[149085, 3811, 257, 5, 19, "Print",ExpressionUUID->"bdbcba1b-7c23-464f-a792-bcb0e67a35e1"]
}, Open  ]],
Cell[149357, 3819, 3150, 85, 52, "Output",ExpressionUUID->"0b9a860e-2280-418a-9c92-5a6c9e6e638f"],
Cell[152510, 3906, 259, 5, 19, "Print",ExpressionUUID->"1b65f831-399c-471c-9656-c3c70a7462b3"],
Cell[152772, 3913, 223, 3, 28, "Output",ExpressionUUID->"3bc5568e-0d18-4c13-8cd4-a9133c560649"]
}, Open  ]],
Cell[CellGroupData[{
Cell[153032, 3921, 2555, 62, 197, "Input",ExpressionUUID->"f63053c5-359d-4fd4-8104-fe18ef926b12"],
Cell[CellGroupData[{
Cell[155612, 3987, 387, 7, 19, "Print",ExpressionUUID->"f1a3692f-f1ff-4014-b85b-2e9d1e8c49a8"],
Cell[156002, 3996, 354, 6, 19, "Print",ExpressionUUID->"5f0d0b00-be67-4700-b760-0cb082c88993"],
Cell[156359, 4004, 382, 7, 19, "Print",ExpressionUUID->"6479f6b7-8f57-41e7-a4d6-22c000ef2ea5"]
}, Open  ]],
Cell[156756, 4014, 3165, 83, 54, "Output",ExpressionUUID->"5312d412-3d72-4a01-8b27-3ccdbf194783"],
Cell[159924, 4099, 382, 7, 19, "Print",ExpressionUUID->"4e3fe0a1-83ea-4a1f-9dcb-366657001871"],
Cell[160309, 4108, 516, 7, 28, "Output",ExpressionUUID->"4b6d91e3-a371-4280-88d4-0eed17db6e44"],
Cell[CellGroupData[{
Cell[160850, 4119, 350, 6, 19, "Print",ExpressionUUID->"3a963d8e-8f6f-431f-88d2-20ca7b898ed5"],
Cell[161203, 4127, 382, 7, 19, "Print",ExpressionUUID->"f00cf712-4dfc-4c90-9aa8-954a5691e887"]
}, Open  ]],
Cell[161600, 4137, 532, 8, 28, "Output",ExpressionUUID->"08dc9056-c9e2-4f16-8b3a-13ea2614201f"],
Cell[162135, 4147, 384, 7, 19, "Print",ExpressionUUID->"54b7091a-327a-43fe-9822-da06031e8131"],
Cell[162522, 4156, 536, 8, 28, "Output",ExpressionUUID->"c3a7f145-c70d-452f-80b2-b90ea44ffb02"]
}, Open  ]],
Cell[163073, 4167, 282, 6, 31, "Text",ExpressionUUID->"893e8715-511f-4340-9a78-85833e3ae934"]
}, Open  ]]
}
]
*)

